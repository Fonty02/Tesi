Tue 16 Apr 2024 22:21:43 INFO  ['src/default_tracker.py', '--dataset=ml-10m_50U10I', '--model=DMF']
Tue 16 Apr 2024 22:21:43 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/ml-10m_50U10I
checkpoint_dir = saved/ml-10m_50U10I/DMF
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
inter_matrix_type = 01
user_embedding_size = 64
item_embedding_size = 64
user_hidden_size_list = [64, 64]
item_hidden_size_list = [64, 64]
embedding_size = 10
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Tue 16 Apr 2024 22:22:04 INFO  ml-10m_50U10I
The number of users: 50001
Average actions of users: 141.07548
The number of items: 10001
Average actions of items: 705.3774
The number of inters: 7053774
The sparsity of the dataset: 98.5894144730844%
Remain Fields: ['user_id', 'item_id']
Tue 16 Apr 2024 22:22:23 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Tue 16 Apr 2024 22:22:23 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Tue 16 Apr 2024 22:22:26 WARNING  Max value of item's history interaction records has reached 40.36719265614688% of the total.
Tue 16 Apr 2024 22:22:36 WARNING  Max value of user's history interaction records has reached 56.7943205679432% of the total.
Tue 16 Apr 2024 22:22:46 INFO  DMF(
  (user_linear): Linear(in_features=10001, out_features=64, bias=False)
  (item_linear): Linear(in_features=50001, out_features=64, bias=False)
  (user_fc_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
      (3): Dropout(p=0.0, inplace=False)
      (4): Linear(in_features=64, out_features=64, bias=True)
      (5): ReLU()
    )
  )
  (item_fc_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
      (3): Dropout(p=0.0, inplace=False)
      (4): Linear(in_features=64, out_features=64, bias=True)
      (5): ReLU()
    )
  )
  (sigmoid): Sigmoid()
  (bce_loss): BCEWithLogitsLoss()
)
Trainable parameters: 3856768
Tue 16 Apr 2024 22:22:53 INFO  FLOPs: 3856512.0
Tue 16 Apr 2024 22:25:36 INFO  epoch 0 training [time: 126.81s, train loss: 2822.9158]
Tue 16 Apr 2024 22:28:19 INFO  epoch 0 evaluating [time: 163.23s, valid_score: 0.299100]
Tue 16 Apr 2024 22:28:19 INFO  valid result: 
recall@10 : 0.1515    mrr@10 : 0.2991    ndcg@10 : 0.1725    hit@10 : 0.6076    map@10 : 0.0917    precision@10 : 0.1221    gauc : 0.9299    itemcoverage@10 : 0.0997    averagepopularity@10 : 12426.5331    giniindex@10 : 0.9898    shannonentropy@10 : 0.0048    tailpercentage@10 : 0.0
Tue 16 Apr 2024 22:28:20 INFO  Saving current: saved/ml-10m_50U10I/DMF/DMF-Apr-16-2024_22-22-53.pth
Tue 16 Apr 2024 22:30:25 INFO  epoch 1 training [time: 125.21s, train loss: 2768.4311]
Tue 16 Apr 2024 22:33:08 INFO  epoch 1 evaluating [time: 163.18s, valid_score: 0.298000]
Tue 16 Apr 2024 22:33:08 INFO  valid result: 
recall@10 : 0.154    mrr@10 : 0.298    ndcg@10 : 0.1729    hit@10 : 0.6175    map@10 : 0.0909    precision@10 : 0.1233    gauc : 0.9315    itemcoverage@10 : 0.1225    averagepopularity@10 : 11036.7436    giniindex@10 : 0.9856    shannonentropy@10 : 0.0042    tailpercentage@10 : 0.0
Tue 16 Apr 2024 22:35:13 INFO  epoch 2 training [time: 125.18s, train loss: 2758.1202]
Tue 16 Apr 2024 22:37:55 INFO  epoch 2 evaluating [time: 161.58s, valid_score: 0.302100]
Tue 16 Apr 2024 22:37:55 INFO  valid result: 
recall@10 : 0.1595    mrr@10 : 0.3021    ndcg@10 : 0.1758    hit@10 : 0.6235    map@10 : 0.0929    precision@10 : 0.1237    gauc : 0.9317    itemcoverage@10 : 0.1345    averagepopularity@10 : 9836.5968    giniindex@10 : 0.9815    shannonentropy@10 : 0.004    tailpercentage@10 : 0.0
Tue 16 Apr 2024 22:37:55 INFO  Saving current: saved/ml-10m_50U10I/DMF/DMF-Apr-16-2024_22-22-53.pth
Tue 16 Apr 2024 22:40:00 INFO  epoch 3 training [time: 124.91s, train loss: 2753.5402]
Tue 16 Apr 2024 22:42:43 INFO  epoch 3 evaluating [time: 162.60s, valid_score: 0.304700]
Tue 16 Apr 2024 22:42:43 INFO  valid result: 
recall@10 : 0.1628    mrr@10 : 0.3047    ndcg@10 : 0.1783    hit@10 : 0.6272    map@10 : 0.0946    precision@10 : 0.125    gauc : 0.9302    itemcoverage@10 : 0.1374    averagepopularity@10 : 10266.2506    giniindex@10 : 0.9812    shannonentropy@10 : 0.0039    tailpercentage@10 : 0.0
Tue 16 Apr 2024 22:42:43 INFO  Saving current: saved/ml-10m_50U10I/DMF/DMF-Apr-16-2024_22-22-53.pth
Tue 16 Apr 2024 22:44:48 INFO  epoch 4 training [time: 124.88s, train loss: 2749.9673]
Tue 16 Apr 2024 22:47:32 INFO  epoch 4 evaluating [time: 163.36s, valid_score: 0.287700]
Tue 16 Apr 2024 22:47:32 INFO  valid result: 
recall@10 : 0.1579    mrr@10 : 0.2877    ndcg@10 : 0.1704    hit@10 : 0.6252    map@10 : 0.0875    precision@10 : 0.1247    gauc : 0.9302    itemcoverage@10 : 0.1365    averagepopularity@10 : 9355.5331    giniindex@10 : 0.9802    shannonentropy@10 : 0.004    tailpercentage@10 : 0.0
Tue 16 Apr 2024 22:49:37 INFO  epoch 5 training [time: 125.08s, train loss: 2747.8826]
Tue 16 Apr 2024 22:52:20 INFO  epoch 5 evaluating [time: 162.98s, valid_score: 0.302300]
Tue 16 Apr 2024 22:52:20 INFO  valid result: 
recall@10 : 0.161    mrr@10 : 0.3023    ndcg@10 : 0.1777    hit@10 : 0.6278    map@10 : 0.0939    precision@10 : 0.1267    gauc : 0.9294    itemcoverage@10 : 0.1391    averagepopularity@10 : 10380.1159    giniindex@10 : 0.9813    shannonentropy@10 : 0.0039    tailpercentage@10 : 0.0
Tue 16 Apr 2024 22:54:25 INFO  epoch 6 training [time: 125.11s, train loss: 2746.5714]
Tue 16 Apr 2024 22:57:08 INFO  epoch 6 evaluating [time: 162.65s, valid_score: 0.303600]
Tue 16 Apr 2024 22:57:08 INFO  valid result: 
recall@10 : 0.1548    mrr@10 : 0.3036    ndcg@10 : 0.1746    hit@10 : 0.6239    map@10 : 0.0919    precision@10 : 0.1239    gauc : 0.9297    itemcoverage@10 : 0.1339    averagepopularity@10 : 9151.2381    giniindex@10 : 0.9783    shannonentropy@10 : 0.0042    tailpercentage@10 : 0.0
Tue 16 Apr 2024 22:59:13 INFO  epoch 7 training [time: 124.98s, train loss: 2745.3768]
Tue 16 Apr 2024 23:01:58 INFO  epoch 7 evaluating [time: 165.70s, valid_score: 0.301900]
Tue 16 Apr 2024 23:01:58 INFO  valid result: 
recall@10 : 0.1568    mrr@10 : 0.3019    ndcg@10 : 0.1753    hit@10 : 0.6248    map@10 : 0.0919    precision@10 : 0.1259    gauc : 0.9293    itemcoverage@10 : 0.1325    averagepopularity@10 : 10487.2986    giniindex@10 : 0.9821    shannonentropy@10 : 0.004    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:04:03 INFO  epoch 8 training [time: 125.16s, train loss: 2745.3255]
Tue 16 Apr 2024 23:06:46 INFO  epoch 8 evaluating [time: 163.08s, valid_score: 0.294000]
Tue 16 Apr 2024 23:06:46 INFO  valid result: 
recall@10 : 0.1513    mrr@10 : 0.294    ndcg@10 : 0.1703    hit@10 : 0.6163    map@10 : 0.0883    precision@10 : 0.1235    gauc : 0.9297    itemcoverage@10 : 0.1361    averagepopularity@10 : 10290.5366    giniindex@10 : 0.9816    shannonentropy@10 : 0.004    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:08:52 INFO  epoch 9 training [time: 125.17s, train loss: 2744.8710]
Tue 16 Apr 2024 23:11:34 INFO  epoch 9 evaluating [time: 162.54s, valid_score: 0.293200]
Tue 16 Apr 2024 23:11:34 INFO  valid result: 
recall@10 : 0.1512    mrr@10 : 0.2932    ndcg@10 : 0.1697    hit@10 : 0.6172    map@10 : 0.0877    precision@10 : 0.1242    gauc : 0.93    itemcoverage@10 : 0.1348    averagepopularity@10 : 9433.0041    giniindex@10 : 0.9798    shannonentropy@10 : 0.0041    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:13:39 INFO  epoch 10 training [time: 125.20s, train loss: 2743.2990]
Tue 16 Apr 2024 23:16:23 INFO  epoch 10 evaluating [time: 163.44s, valid_score: 0.304400]
Tue 16 Apr 2024 23:16:23 INFO  valid result: 
recall@10 : 0.1594    mrr@10 : 0.3044    ndcg@10 : 0.1773    hit@10 : 0.6296    map@10 : 0.0932    precision@10 : 0.1266    gauc : 0.9305    itemcoverage@10 : 0.132    averagepopularity@10 : 10198.5403    giniindex@10 : 0.9821    shannonentropy@10 : 0.0041    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:18:28 INFO  epoch 11 training [time: 125.38s, train loss: 2743.6390]
Tue 16 Apr 2024 23:21:11 INFO  epoch 11 evaluating [time: 163.26s, valid_score: 0.285100]
Tue 16 Apr 2024 23:21:11 INFO  valid result: 
recall@10 : 0.1464    mrr@10 : 0.2851    ndcg@10 : 0.1646    hit@10 : 0.6085    map@10 : 0.0847    precision@10 : 0.1199    gauc : 0.929    itemcoverage@10 : 0.1349    averagepopularity@10 : 9893.8819    giniindex@10 : 0.9806    shannonentropy@10 : 0.0041    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:23:17 INFO  epoch 12 training [time: 125.04s, train loss: 2742.2526]
Tue 16 Apr 2024 23:26:01 INFO  epoch 12 evaluating [time: 164.48s, valid_score: 0.294200]
Tue 16 Apr 2024 23:26:01 INFO  valid result: 
recall@10 : 0.1497    mrr@10 : 0.2942    ndcg@10 : 0.1677    hit@10 : 0.6138    map@10 : 0.0864    precision@10 : 0.1209    gauc : 0.9292    itemcoverage@10 : 0.1432    averagepopularity@10 : 9625.9598    giniindex@10 : 0.9791    shannonentropy@10 : 0.0039    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:28:06 INFO  epoch 13 training [time: 125.31s, train loss: 2742.8872]
Tue 16 Apr 2024 23:30:50 INFO  epoch 13 evaluating [time: 163.55s, valid_score: 0.278100]
Tue 16 Apr 2024 23:30:50 INFO  valid result: 
recall@10 : 0.1409    mrr@10 : 0.2781    ndcg@10 : 0.1587    hit@10 : 0.5974    map@10 : 0.0805    precision@10 : 0.1166    gauc : 0.9298    itemcoverage@10 : 0.1361    averagepopularity@10 : 8766.7571    giniindex@10 : 0.9774    shannonentropy@10 : 0.0042    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:32:55 INFO  epoch 14 training [time: 125.11s, train loss: 2741.2568]
Tue 16 Apr 2024 23:35:38 INFO  epoch 14 evaluating [time: 162.60s, valid_score: 0.279100]
Tue 16 Apr 2024 23:35:38 INFO  valid result: 
recall@10 : 0.145    mrr@10 : 0.2791    ndcg@10 : 0.1618    hit@10 : 0.6034    map@10 : 0.0829    precision@10 : 0.1185    gauc : 0.9279    itemcoverage@10 : 0.1362    averagepopularity@10 : 9090.2231    giniindex@10 : 0.9782    shannonentropy@10 : 0.0041    tailpercentage@10 : 0.0
Tue 16 Apr 2024 23:35:38 INFO  Finished training, best eval result in epoch 3
Tue 16 Apr 2024 23:35:39 INFO  Loading model structure and parameters from saved/ml-10m_50U10I/DMF/DMF-Apr-16-2024_22-22-53.pth
Tue 16 Apr 2024 23:38:20 INFO  The running environment of this training is as follows:
+-------------+-----------------+
| Environment |      Usage      |
+=============+=================+
| CPU         |     5.00 %      |
+-------------+-----------------+
| GPU         | 10.93 G/15.57 G |
+-------------+-----------------+
| Memory      | 3.00 G/27.41 G  |
+-------------+-----------------+
Tue 16 Apr 2024 23:38:20 INFO  best valid : OrderedDict([('recall@10', 0.1628), ('mrr@10', 0.3047), ('ndcg@10', 0.1783), ('hit@10', 0.6272), ('map@10', 0.0946), ('precision@10', 0.125), ('gauc', 0.9302), ('itemcoverage@10', 0.1374), ('averagepopularity@10', 10266.2506), ('giniindex@10', 0.9812), ('shannonentropy@10', 0.0039), ('tailpercentage@10', 0.0)])
Tue 16 Apr 2024 23:38:20 INFO  test result: OrderedDict([('recall@10', 0.1791), ('mrr@10', 0.3591), ('ndcg@10', 0.2143), ('hit@10', 0.6508), ('map@10', 0.1245), ('precision@10', 0.1493), ('gauc', 0.9324), ('itemcoverage@10', 0.1543), ('averagepopularity@10', 9939.8111), ('giniindex@10', 0.9787), ('shannonentropy@10', 0.0036), ('tailpercentage@10', 0.0)])
Tue 16 Apr 2024 23:38:21 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/ml-10m_50U10I
checkpoint_dir = saved/ml-10m_50U10I/DMF
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
inter_matrix_type = 01
user_embedding_size = 64
item_embedding_size = 64
user_hidden_size_list = [64, 64]
item_hidden_size_list = [64, 64]
embedding_size = 10
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Tue 16 Apr 2024 23:38:43 INFO  ml-10m_50U10I
The number of users: 50001
Average actions of users: 141.07548
The number of items: 10001
Average actions of items: 705.3774
The number of inters: 7053774
The sparsity of the dataset: 98.5894144730844%
Remain Fields: ['user_id', 'item_id']
Tue 16 Apr 2024 23:39:01 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Tue 16 Apr 2024 23:39:01 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Tue 16 Apr 2024 23:39:04 WARNING  Max value of item's history interaction records has reached 40.36719265614688% of the total.
Tue 16 Apr 2024 23:39:14 WARNING  Max value of user's history interaction records has reached 56.7943205679432% of the total.
Tue 16 Apr 2024 23:39:26 INFO  Loading model structure and parameters from saved/ml-10m_50U10I/DMF/DMF-Apr-16-2024_22-22-53.pth
