Sat 06 Apr 2024 03:05:47 INFO  ['src/default_tracker.py', '--dataset=LFM-1b_artist_20U50I_25strat', '--model=DMF']
Sat 06 Apr 2024 03:05:47 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/LFM-1b_artist_20U50I_25strat
checkpoint_dir = saved/LFM-1b_artist_20U50I_25strat/DMF
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
inter_matrix_type = 01
user_embedding_size = 64
item_embedding_size = 64
user_hidden_size_list = [64, 64]
item_hidden_size_list = [64, 64]
embedding_size = 10
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Sat 06 Apr 2024 03:05:49 INFO  LFM-1b_artist_20U50I_25strat
The number of users: 19842
Average actions of users: 11.01038254120256
The number of items: 24879
Average actions of items: 8.781131923788086
The number of inters: 218457
The sparsity of the dataset: 99.95574650251882%
Remain Fields: ['user_id', 'item_id']
Sat 06 Apr 2024 03:05:50 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Sat 06 Apr 2024 03:05:50 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Sat 06 Apr 2024 03:05:51 INFO  DMF(
  (user_linear): Linear(in_features=24879, out_features=64, bias=False)
  (item_linear): Linear(in_features=19842, out_features=64, bias=False)
  (user_fc_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
      (3): Dropout(p=0.0, inplace=False)
      (4): Linear(in_features=64, out_features=64, bias=True)
      (5): ReLU()
    )
  )
  (item_fc_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
      (3): Dropout(p=0.0, inplace=False)
      (4): Linear(in_features=64, out_features=64, bias=True)
      (5): ReLU()
    )
  )
  (sigmoid): Sigmoid()
  (bce_loss): BCEWithLogitsLoss()
)
Trainable parameters: 2878784
Sat 06 Apr 2024 03:05:58 INFO  FLOPs: 2878528.0
Sat 06 Apr 2024 03:06:35 INFO  epoch 0 training [time: 3.91s, train loss: 93.2579]
Sat 06 Apr 2024 03:07:00 INFO  epoch 0 evaluating [time: 24.85s, valid_score: 0.027700]
Sat 06 Apr 2024 03:07:00 INFO  valid result: 
recall@10 : 0.0541    mrr@10 : 0.0277    ndcg@10 : 0.0311    hit@10 : 0.0682    precision@10 : 0.0069
Sat 06 Apr 2024 03:07:00 INFO  Saving current: saved/LFM-1b_artist_20U50I_25strat/DMF/DMF-Apr-06-2024_03-05-59.pth
Sat 06 Apr 2024 03:07:02 INFO  epoch 1 training [time: 1.78s, train loss: 89.7373]
Sat 06 Apr 2024 03:07:25 INFO  epoch 1 evaluating [time: 22.96s, valid_score: 0.021000]
Sat 06 Apr 2024 03:07:25 INFO  valid result: 
recall@10 : 0.0582    mrr@10 : 0.021    ndcg@10 : 0.0275    hit@10 : 0.0725    precision@10 : 0.0073
Sat 06 Apr 2024 03:07:27 INFO  epoch 2 training [time: 1.89s, train loss: 89.5120]
Sat 06 Apr 2024 03:07:50 INFO  epoch 2 evaluating [time: 23.11s, valid_score: 0.029800]
Sat 06 Apr 2024 03:07:50 INFO  valid result: 
recall@10 : 0.0638    mrr@10 : 0.0298    ndcg@10 : 0.0347    hit@10 : 0.0807    precision@10 : 0.0082
Sat 06 Apr 2024 03:07:51 INFO  Saving current: saved/LFM-1b_artist_20U50I_25strat/DMF/DMF-Apr-06-2024_03-05-59.pth
Sat 06 Apr 2024 03:07:52 INFO  epoch 3 training [time: 1.78s, train loss: 89.4836]
Sat 06 Apr 2024 03:08:15 INFO  epoch 3 evaluating [time: 23.08s, valid_score: 0.025600]
Sat 06 Apr 2024 03:08:15 INFO  valid result: 
recall@10 : 0.0651    mrr@10 : 0.0256    ndcg@10 : 0.0323    hit@10 : 0.0806    precision@10 : 0.0081
Sat 06 Apr 2024 03:08:17 INFO  epoch 4 training [time: 1.90s, train loss: 89.3133]
Sat 06 Apr 2024 03:08:41 INFO  epoch 4 evaluating [time: 23.14s, valid_score: 0.023500]
Sat 06 Apr 2024 03:08:41 INFO  valid result: 
recall@10 : 0.0662    mrr@10 : 0.0235    ndcg@10 : 0.0314    hit@10 : 0.0816    precision@10 : 0.0083
Sat 06 Apr 2024 03:08:42 INFO  epoch 5 training [time: 1.91s, train loss: 89.4324]
Sat 06 Apr 2024 03:09:06 INFO  epoch 5 evaluating [time: 23.11s, valid_score: 0.029600]
Sat 06 Apr 2024 03:09:06 INFO  valid result: 
recall@10 : 0.0697    mrr@10 : 0.0296    ndcg@10 : 0.0358    hit@10 : 0.0866    precision@10 : 0.0088
Sat 06 Apr 2024 03:09:07 INFO  epoch 6 training [time: 1.87s, train loss: 89.3106]
Sat 06 Apr 2024 03:09:31 INFO  epoch 6 evaluating [time: 23.26s, valid_score: 0.020200]
Sat 06 Apr 2024 03:09:31 INFO  valid result: 
recall@10 : 0.0563    mrr@10 : 0.0202    ndcg@10 : 0.0264    hit@10 : 0.0716    precision@10 : 0.0073
Sat 06 Apr 2024 03:09:33 INFO  epoch 7 training [time: 1.87s, train loss: 89.3863]
Sat 06 Apr 2024 03:09:56 INFO  epoch 7 evaluating [time: 23.18s, valid_score: 0.022100]
Sat 06 Apr 2024 03:09:56 INFO  valid result: 
recall@10 : 0.0542    mrr@10 : 0.0221    ndcg@10 : 0.0274    hit@10 : 0.0682    precision@10 : 0.0069
Sat 06 Apr 2024 03:09:58 INFO  epoch 8 training [time: 1.90s, train loss: 89.1568]
Sat 06 Apr 2024 03:10:21 INFO  epoch 8 evaluating [time: 23.13s, valid_score: 0.023900]
Sat 06 Apr 2024 03:10:21 INFO  valid result: 
recall@10 : 0.0621    mrr@10 : 0.0239    ndcg@10 : 0.0304    hit@10 : 0.0775    precision@10 : 0.0078
Sat 06 Apr 2024 03:10:23 INFO  epoch 9 training [time: 1.94s, train loss: 89.1331]
Sat 06 Apr 2024 03:10:46 INFO  epoch 9 evaluating [time: 23.25s, valid_score: 0.029800]
Sat 06 Apr 2024 03:10:46 INFO  valid result: 
recall@10 : 0.07    mrr@10 : 0.0298    ndcg@10 : 0.0364    hit@10 : 0.0869    precision@10 : 0.0088
Sat 06 Apr 2024 03:10:47 INFO  Saving current: saved/LFM-1b_artist_20U50I_25strat/DMF/DMF-Apr-06-2024_03-05-59.pth
Sat 06 Apr 2024 03:10:48 INFO  epoch 10 training [time: 1.78s, train loss: 89.3483]
Sat 06 Apr 2024 03:11:12 INFO  epoch 10 evaluating [time: 23.18s, valid_score: 0.028800]
Sat 06 Apr 2024 03:11:12 INFO  valid result: 
recall@10 : 0.0649    mrr@10 : 0.0288    ndcg@10 : 0.0346    hit@10 : 0.079    precision@10 : 0.008
Sat 06 Apr 2024 03:11:14 INFO  epoch 11 training [time: 1.95s, train loss: 89.1595]
Sat 06 Apr 2024 03:11:37 INFO  epoch 11 evaluating [time: 23.17s, valid_score: 0.029700]
Sat 06 Apr 2024 03:11:37 INFO  valid result: 
recall@10 : 0.0655    mrr@10 : 0.0297    ndcg@10 : 0.0355    hit@10 : 0.0801    precision@10 : 0.0081
Sat 06 Apr 2024 03:11:39 INFO  epoch 12 training [time: 1.93s, train loss: 89.0557]
Sat 06 Apr 2024 03:12:02 INFO  epoch 12 evaluating [time: 23.19s, valid_score: 0.025000]
Sat 06 Apr 2024 03:12:02 INFO  valid result: 
recall@10 : 0.0628    mrr@10 : 0.025    ndcg@10 : 0.0313    hit@10 : 0.0773    precision@10 : 0.0078
Sat 06 Apr 2024 03:12:04 INFO  epoch 13 training [time: 1.91s, train loss: 88.9124]
Sat 06 Apr 2024 03:12:27 INFO  epoch 13 evaluating [time: 23.16s, valid_score: 0.028000]
Sat 06 Apr 2024 03:12:27 INFO  valid result: 
recall@10 : 0.0732    mrr@10 : 0.028    ndcg@10 : 0.0356    hit@10 : 0.0892    precision@10 : 0.009
Sat 06 Apr 2024 03:12:29 INFO  epoch 14 training [time: 1.89s, train loss: 88.3878]
Sat 06 Apr 2024 03:12:52 INFO  epoch 14 evaluating [time: 23.18s, valid_score: 0.023400]
Sat 06 Apr 2024 03:12:52 INFO  valid result: 
recall@10 : 0.0603    mrr@10 : 0.0234    ndcg@10 : 0.0297    hit@10 : 0.0745    precision@10 : 0.0075
Sat 06 Apr 2024 03:12:54 INFO  epoch 15 training [time: 1.89s, train loss: 87.8248]
Sat 06 Apr 2024 03:13:17 INFO  epoch 15 evaluating [time: 23.26s, valid_score: 0.021100]
Sat 06 Apr 2024 03:13:17 INFO  valid result: 
recall@10 : 0.0589    mrr@10 : 0.0211    ndcg@10 : 0.0282    hit@10 : 0.0704    precision@10 : 0.0071
Sat 06 Apr 2024 03:13:19 INFO  epoch 16 training [time: 1.90s, train loss: 87.4355]
Sat 06 Apr 2024 03:13:42 INFO  epoch 16 evaluating [time: 23.21s, valid_score: 0.023200]
Sat 06 Apr 2024 03:13:42 INFO  valid result: 
recall@10 : 0.062    mrr@10 : 0.0232    ndcg@10 : 0.0307    hit@10 : 0.0739    precision@10 : 0.0075
Sat 06 Apr 2024 03:13:44 INFO  epoch 17 training [time: 1.91s, train loss: 87.1889]
Sat 06 Apr 2024 03:14:07 INFO  epoch 17 evaluating [time: 23.11s, valid_score: 0.027300]
Sat 06 Apr 2024 03:14:07 INFO  valid result: 
recall@10 : 0.0639    mrr@10 : 0.0273    ndcg@10 : 0.0336    hit@10 : 0.0771    precision@10 : 0.0078
Sat 06 Apr 2024 03:14:09 INFO  epoch 18 training [time: 1.90s, train loss: 86.8242]
Sat 06 Apr 2024 03:14:32 INFO  epoch 18 evaluating [time: 23.09s, valid_score: 0.021300]
Sat 06 Apr 2024 03:14:32 INFO  valid result: 
recall@10 : 0.0608    mrr@10 : 0.0213    ndcg@10 : 0.0287    hit@10 : 0.0718    precision@10 : 0.0072
Sat 06 Apr 2024 03:14:34 INFO  epoch 19 training [time: 1.92s, train loss: 86.8652]
Sat 06 Apr 2024 03:14:57 INFO  epoch 19 evaluating [time: 22.88s, valid_score: 0.023800]
Sat 06 Apr 2024 03:14:57 INFO  valid result: 
recall@10 : 0.0585    mrr@10 : 0.0238    ndcg@10 : 0.0302    hit@10 : 0.0689    precision@10 : 0.0069
Sat 06 Apr 2024 03:14:59 INFO  epoch 20 training [time: 1.89s, train loss: 86.6066]
Sat 06 Apr 2024 03:15:22 INFO  epoch 20 evaluating [time: 22.89s, valid_score: 0.029300]
Sat 06 Apr 2024 03:15:22 INFO  valid result: 
recall@10 : 0.0693    mrr@10 : 0.0293    ndcg@10 : 0.0361    hit@10 : 0.084    precision@10 : 0.0085
Sat 06 Apr 2024 03:15:22 INFO  Finished training, best eval result in epoch 9
Sat 06 Apr 2024 03:15:23 INFO  Loading model structure and parameters from saved/LFM-1b_artist_20U50I_25strat/DMF/DMF-Apr-06-2024_03-05-59.pth
Sat 06 Apr 2024 03:15:49 INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     1.20 %     |
+-------------+----------------+
| GPU         | 1.04 G/14.58 G |
+-------------+----------------+
| Memory      | 1.19 G/27.41 G |
+-------------+----------------+
Sat 06 Apr 2024 03:15:49 INFO  best valid : OrderedDict([('recall@10', 0.07), ('mrr@10', 0.0298), ('ndcg@10', 0.0364), ('hit@10', 0.0869), ('precision@10', 0.0088)])
Sat 06 Apr 2024 03:15:49 INFO  test result: OrderedDict([('recall@10', 0.0693), ('mrr@10', 0.0281), ('ndcg@10', 0.0356), ('hit@10', 0.0816), ('precision@10', 0.0083)])
Sat 06 Apr 2024 03:15:51 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/LFM-1b_artist_20U50I_25strat
checkpoint_dir = saved/LFM-1b_artist_20U50I_25strat/DMF
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
inter_matrix_type = 01
user_embedding_size = 64
item_embedding_size = 64
user_hidden_size_list = [64, 64]
item_hidden_size_list = [64, 64]
embedding_size = 10
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Sat 06 Apr 2024 03:15:51 INFO  LFM-1b_artist_20U50I_25strat
The number of users: 19842
Average actions of users: 11.01038254120256
The number of items: 24879
Average actions of items: 8.781131923788086
The number of inters: 218457
The sparsity of the dataset: 99.95574650251882%
Remain Fields: ['user_id', 'item_id']
Sat 06 Apr 2024 03:15:53 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Sat 06 Apr 2024 03:15:53 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Sat 06 Apr 2024 03:15:54 INFO  Loading model structure and parameters from saved/LFM-1b_artist_20U50I_25strat/DMF/DMF-Apr-06-2024_03-05-59.pth
