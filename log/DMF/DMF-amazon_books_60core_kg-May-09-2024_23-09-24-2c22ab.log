Thu 09 May 2024 23:09:24 INFO  ['src/default_tracker2.py', '--dataset=amazon_books_60core_kg', '--model=DMF', '--max_emission_step=-1']
Thu 09 May 2024 23:09:24 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/amazon_books_60core_kg
checkpoint_dir = saved/amazon_books_60core_kg/DMF
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
inter_matrix_type = 01
user_embedding_size = 64
item_embedding_size = 64
user_hidden_size_list = [64, 64]
item_hidden_size_list = [64, 64]
embedding_size = 10
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
encoding = utf-8
device = cuda:1
my_log_file = /home/fontana/Tesi/log/carbon_default.log
max_emission_step = -1
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Thu 09 May 2024 23:09:30 INFO  amazon_books_60core_kg
The number of users: 22156
Average actions of users: 66.16434213495825
The number of items: 54459
Average actions of items: 26.917459326453415
The number of inters: 1465871
The sparsity of the dataset: 99.87851162187994%
Remain Fields: ['user_id', 'item_id']
Thu 09 May 2024 23:09:35 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Thu 09 May 2024 23:09:35 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Thu 09 May 2024 23:09:44 INFO  DMF(
  (user_linear): Linear(in_features=54459, out_features=64, bias=False)
  (item_linear): Linear(in_features=22156, out_features=64, bias=False)
  (user_fc_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
      (3): Dropout(p=0.0, inplace=False)
      (4): Linear(in_features=64, out_features=64, bias=True)
      (5): ReLU()
    )
  )
  (item_fc_layers): MLPLayers(
    (mlp_layers): Sequential(
      (0): Dropout(p=0.0, inplace=False)
      (1): Linear(in_features=64, out_features=64, bias=True)
      (2): ReLU()
      (3): Dropout(p=0.0, inplace=False)
      (4): Linear(in_features=64, out_features=64, bias=True)
      (5): ReLU()
    )
  )
  (sigmoid): Sigmoid()
  (bce_loss): BCEWithLogitsLoss()
)
Trainable parameters: 4920000
Thu 09 May 2024 23:09:44 INFO  FLOPs: 4919744.0
Thu 09 May 2024 23:10:18 INFO  epoch 0 training [time: 28.10s, train loss: 700.4020]
Thu 09 May 2024 23:12:16 INFO  epoch 0 evaluating [time: 118.11s, valid_score: 0.025900]
Thu 09 May 2024 23:12:16 INFO  valid result: 
recall@10 : 0.0107    mrr@10 : 0.0259    ndcg@10 : 0.0112    hit@10 : 0.0713    map@10 : 0.0044    precision@10 : 0.0082    gauc : 0.868    itemcoverage@10 : 0.005    averagepopularity@10 : 277.3637    giniindex@10 : 0.9986    shannonentropy@10 : 0.0171    tailpercentage@10 : 0.0
Thu 09 May 2024 23:12:17 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:12:45 INFO  epoch 1 training [time: 28.02s, train loss: 637.7517]
Thu 09 May 2024 23:14:42 INFO  epoch 1 evaluating [time: 117.56s, valid_score: 0.029700]
Thu 09 May 2024 23:14:42 INFO  valid result: 
recall@10 : 0.0126    mrr@10 : 0.0297    ndcg@10 : 0.0129    hit@10 : 0.082    map@10 : 0.0051    precision@10 : 0.0095    gauc : 0.8895    itemcoverage@10 : 0.0098    averagepopularity@10 : 254.8387    giniindex@10 : 0.9974    shannonentropy@10 : 0.0098    tailpercentage@10 : 0.0
Thu 09 May 2024 23:14:43 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:15:11 INFO  epoch 2 training [time: 28.05s, train loss: 613.3926]
Thu 09 May 2024 23:17:08 INFO  epoch 2 evaluating [time: 117.58s, valid_score: 0.034700]
Thu 09 May 2024 23:17:08 INFO  valid result: 
recall@10 : 0.0151    mrr@10 : 0.0347    ndcg@10 : 0.0153    hit@10 : 0.0947    map@10 : 0.0063    precision@10 : 0.011    gauc : 0.9008    itemcoverage@10 : 0.0136    averagepopularity@10 : 229.4084    giniindex@10 : 0.9962    shannonentropy@10 : 0.0076    tailpercentage@10 : 0.0
Thu 09 May 2024 23:17:09 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:17:37 INFO  epoch 3 training [time: 27.92s, train loss: 600.1586]
Thu 09 May 2024 23:19:35 INFO  epoch 3 evaluating [time: 118.13s, valid_score: 0.036600]
Thu 09 May 2024 23:19:35 INFO  valid result: 
recall@10 : 0.0163    mrr@10 : 0.0366    ndcg@10 : 0.0163    hit@10 : 0.101    map@10 : 0.0066    precision@10 : 0.0117    gauc : 0.9047    itemcoverage@10 : 0.0197    averagepopularity@10 : 213.6855    giniindex@10 : 0.995    shannonentropy@10 : 0.0055    tailpercentage@10 : 0.0
Thu 09 May 2024 23:19:36 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:20:04 INFO  epoch 4 training [time: 28.15s, train loss: 591.9598]
Thu 09 May 2024 23:22:01 INFO  epoch 4 evaluating [time: 117.71s, valid_score: 0.037200]
Thu 09 May 2024 23:22:01 INFO  valid result: 
recall@10 : 0.0175    mrr@10 : 0.0372    ndcg@10 : 0.017    hit@10 : 0.1063    map@10 : 0.0069    precision@10 : 0.0123    gauc : 0.9062    itemcoverage@10 : 0.0246    averagepopularity@10 : 192.6269    giniindex@10 : 0.9938    shannonentropy@10 : 0.0046    tailpercentage@10 : 0.0
Thu 09 May 2024 23:22:02 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:22:29 INFO  epoch 5 training [time: 27.29s, train loss: 587.1041]
Thu 09 May 2024 23:24:27 INFO  epoch 5 evaluating [time: 117.90s, valid_score: 0.042000]
Thu 09 May 2024 23:24:27 INFO  valid result: 
recall@10 : 0.0198    mrr@10 : 0.042    ndcg@10 : 0.0192    hit@10 : 0.1136    map@10 : 0.0082    precision@10 : 0.0132    gauc : 0.9094    itemcoverage@10 : 0.0277    averagepopularity@10 : 201.3008    giniindex@10 : 0.9928    shannonentropy@10 : 0.0041    tailpercentage@10 : 0.0
Thu 09 May 2024 23:24:28 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:24:56 INFO  epoch 6 training [time: 27.79s, train loss: 583.5404]
Thu 09 May 2024 23:26:54 INFO  epoch 6 evaluating [time: 117.91s, valid_score: 0.041400]
Thu 09 May 2024 23:26:54 INFO  valid result: 
recall@10 : 0.0197    mrr@10 : 0.0414    ndcg@10 : 0.0188    hit@10 : 0.1134    map@10 : 0.0077    precision@10 : 0.0131    gauc : 0.9087    itemcoverage@10 : 0.032    averagepopularity@10 : 179.7294    giniindex@10 : 0.9917    shannonentropy@10 : 0.0037    tailpercentage@10 : 0.0
Thu 09 May 2024 23:27:21 INFO  epoch 7 training [time: 27.83s, train loss: 579.9299]
Thu 09 May 2024 23:29:19 INFO  epoch 7 evaluating [time: 118.15s, valid_score: 0.040900]
Thu 09 May 2024 23:29:19 INFO  valid result: 
recall@10 : 0.0197    mrr@10 : 0.0409    ndcg@10 : 0.019    hit@10 : 0.1139    map@10 : 0.0079    precision@10 : 0.0133    gauc : 0.9089    itemcoverage@10 : 0.0326    averagepopularity@10 : 177.2023    giniindex@10 : 0.9919    shannonentropy@10 : 0.0036    tailpercentage@10 : 0.0
Thu 09 May 2024 23:29:48 INFO  epoch 8 training [time: 28.02s, train loss: 577.8492]
Thu 09 May 2024 23:31:45 INFO  epoch 8 evaluating [time: 117.92s, valid_score: 0.042500]
Thu 09 May 2024 23:31:45 INFO  valid result: 
recall@10 : 0.0201    mrr@10 : 0.0425    ndcg@10 : 0.0195    hit@10 : 0.1155    map@10 : 0.0082    precision@10 : 0.0135    gauc : 0.9108    itemcoverage@10 : 0.0367    averagepopularity@10 : 182.4423    giniindex@10 : 0.991    shannonentropy@10 : 0.0032    tailpercentage@10 : 0.0
Thu 09 May 2024 23:31:46 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:32:14 INFO  epoch 9 training [time: 27.85s, train loss: 576.6860]
Thu 09 May 2024 23:34:11 INFO  epoch 9 evaluating [time: 117.51s, valid_score: 0.040800]
Thu 09 May 2024 23:34:11 INFO  valid result: 
recall@10 : 0.0201    mrr@10 : 0.0408    ndcg@10 : 0.0191    hit@10 : 0.1147    map@10 : 0.0079    precision@10 : 0.0134    gauc : 0.9115    itemcoverage@10 : 0.0393    averagepopularity@10 : 157.9368    giniindex@10 : 0.9896    shannonentropy@10 : 0.0031    tailpercentage@10 : 0.0
Thu 09 May 2024 23:34:39 INFO  epoch 10 training [time: 27.79s, train loss: 574.8343]
Thu 09 May 2024 23:36:37 INFO  epoch 10 evaluating [time: 118.28s, valid_score: 0.041300]
Thu 09 May 2024 23:36:37 INFO  valid result: 
recall@10 : 0.0202    mrr@10 : 0.0413    ndcg@10 : 0.0192    hit@10 : 0.1141    map@10 : 0.0081    precision@10 : 0.0132    gauc : 0.9105    itemcoverage@10 : 0.0418    averagepopularity@10 : 164.8239    giniindex@10 : 0.9892    shannonentropy@10 : 0.0029    tailpercentage@10 : 0.0
Thu 09 May 2024 23:37:05 INFO  epoch 11 training [time: 27.98s, train loss: 574.1083]
Thu 09 May 2024 23:39:03 INFO  epoch 11 evaluating [time: 117.79s, valid_score: 0.040200]
Thu 09 May 2024 23:39:03 INFO  valid result: 
recall@10 : 0.0199    mrr@10 : 0.0402    ndcg@10 : 0.0188    hit@10 : 0.1136    map@10 : 0.0078    precision@10 : 0.0132    gauc : 0.91    itemcoverage@10 : 0.041    averagepopularity@10 : 171.4368    giniindex@10 : 0.9897    shannonentropy@10 : 0.003    tailpercentage@10 : 0.0
Thu 09 May 2024 23:39:31 INFO  epoch 12 training [time: 27.94s, train loss: 573.1196]
Thu 09 May 2024 23:41:29 INFO  epoch 12 evaluating [time: 118.30s, valid_score: 0.040700]
Thu 09 May 2024 23:41:29 INFO  valid result: 
recall@10 : 0.0202    mrr@10 : 0.0407    ndcg@10 : 0.0191    hit@10 : 0.1158    map@10 : 0.008    precision@10 : 0.0133    gauc : 0.9106    itemcoverage@10 : 0.0438    averagepopularity@10 : 167.4696    giniindex@10 : 0.9892    shannonentropy@10 : 0.0028    tailpercentage@10 : 0.0
Thu 09 May 2024 23:41:57 INFO  epoch 13 training [time: 27.87s, train loss: 572.2517]
Thu 09 May 2024 23:43:56 INFO  epoch 13 evaluating [time: 118.48s, valid_score: 0.040600]
Thu 09 May 2024 23:43:56 INFO  valid result: 
recall@10 : 0.0204    mrr@10 : 0.0406    ndcg@10 : 0.019    hit@10 : 0.1145    map@10 : 0.0079    precision@10 : 0.0132    gauc : 0.9106    itemcoverage@10 : 0.0462    averagepopularity@10 : 159.0457    giniindex@10 : 0.9886    shannonentropy@10 : 0.0027    tailpercentage@10 : 0.0
Thu 09 May 2024 23:44:24 INFO  epoch 14 training [time: 27.96s, train loss: 571.0984]
Thu 09 May 2024 23:46:22 INFO  epoch 14 evaluating [time: 118.06s, valid_score: 0.042000]
Thu 09 May 2024 23:46:22 INFO  valid result: 
recall@10 : 0.0206    mrr@10 : 0.042    ndcg@10 : 0.0196    hit@10 : 0.1165    map@10 : 0.0083    precision@10 : 0.0136    gauc : 0.9114    itemcoverage@10 : 0.0465    averagepopularity@10 : 157.7129    giniindex@10 : 0.9882    shannonentropy@10 : 0.0027    tailpercentage@10 : 0.0
Thu 09 May 2024 23:46:49 INFO  epoch 15 training [time: 27.46s, train loss: 570.2754]
Thu 09 May 2024 23:48:47 INFO  epoch 15 evaluating [time: 117.65s, valid_score: 0.042500]
Thu 09 May 2024 23:48:47 INFO  valid result: 
recall@10 : 0.0213    mrr@10 : 0.0425    ndcg@10 : 0.02    hit@10 : 0.1188    map@10 : 0.0084    precision@10 : 0.0138    gauc : 0.9104    itemcoverage@10 : 0.0479    averagepopularity@10 : 157.0398    giniindex@10 : 0.9876    shannonentropy@10 : 0.0026    tailpercentage@10 : 0.0
Thu 09 May 2024 23:48:48 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:49:16 INFO  epoch 16 training [time: 28.09s, train loss: 569.5871]
Thu 09 May 2024 23:51:14 INFO  epoch 16 evaluating [time: 118.09s, valid_score: 0.042000]
Thu 09 May 2024 23:51:14 INFO  valid result: 
recall@10 : 0.0208    mrr@10 : 0.042    ndcg@10 : 0.0196    hit@10 : 0.1177    map@10 : 0.0082    precision@10 : 0.0137    gauc : 0.9096    itemcoverage@10 : 0.0476    averagepopularity@10 : 162.9098    giniindex@10 : 0.988    shannonentropy@10 : 0.0026    tailpercentage@10 : 0.0
Thu 09 May 2024 23:51:42 INFO  epoch 17 training [time: 27.89s, train loss: 569.6016]
Thu 09 May 2024 23:53:40 INFO  epoch 17 evaluating [time: 118.05s, valid_score: 0.041800]
Thu 09 May 2024 23:53:40 INFO  valid result: 
recall@10 : 0.0211    mrr@10 : 0.0418    ndcg@10 : 0.0198    hit@10 : 0.1187    map@10 : 0.0083    precision@10 : 0.0139    gauc : 0.9108    itemcoverage@10 : 0.0494    averagepopularity@10 : 145.5064    giniindex@10 : 0.9869    shannonentropy@10 : 0.0025    tailpercentage@10 : 0.0
Thu 09 May 2024 23:54:08 INFO  epoch 18 training [time: 28.06s, train loss: 568.8344]
Thu 09 May 2024 23:56:06 INFO  epoch 18 evaluating [time: 118.60s, valid_score: 0.042700]
Thu 09 May 2024 23:56:06 INFO  valid result: 
recall@10 : 0.0207    mrr@10 : 0.0427    ndcg@10 : 0.0196    hit@10 : 0.1171    map@10 : 0.008    precision@10 : 0.0138    gauc : 0.9114    itemcoverage@10 : 0.0528    averagepopularity@10 : 147.1718    giniindex@10 : 0.9865    shannonentropy@10 : 0.0024    tailpercentage@10 : 0.0
Thu 09 May 2024 23:56:07 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Thu 09 May 2024 23:56:35 INFO  epoch 19 training [time: 28.00s, train loss: 568.5423]
Thu 09 May 2024 23:58:33 INFO  epoch 19 evaluating [time: 117.79s, valid_score: 0.042300]
Thu 09 May 2024 23:58:33 INFO  valid result: 
recall@10 : 0.021    mrr@10 : 0.0423    ndcg@10 : 0.0198    hit@10 : 0.1181    map@10 : 0.0083    precision@10 : 0.0138    gauc : 0.9098    itemcoverage@10 : 0.0515    averagepopularity@10 : 147.455    giniindex@10 : 0.9869    shannonentropy@10 : 0.0024    tailpercentage@10 : 0.0
Thu 09 May 2024 23:59:01 INFO  epoch 20 training [time: 28.05s, train loss: 567.8798]
Fri 10 May 2024 00:00:59 INFO  epoch 20 evaluating [time: 118.03s, valid_score: 0.041700]
Fri 10 May 2024 00:00:59 INFO  valid result: 
recall@10 : 0.021    mrr@10 : 0.0417    ndcg@10 : 0.0196    hit@10 : 0.1184    map@10 : 0.0081    precision@10 : 0.0138    gauc : 0.9097    itemcoverage@10 : 0.0513    averagepopularity@10 : 160.9261    giniindex@10 : 0.9872    shannonentropy@10 : 0.0024    tailpercentage@10 : 0.0
Fri 10 May 2024 00:01:27 INFO  epoch 21 training [time: 28.02s, train loss: 567.7854]
Fri 10 May 2024 00:03:25 INFO  epoch 21 evaluating [time: 118.07s, valid_score: 0.042700]
Fri 10 May 2024 00:03:25 INFO  valid result: 
recall@10 : 0.0209    mrr@10 : 0.0427    ndcg@10 : 0.0199    hit@10 : 0.1184    map@10 : 0.0084    precision@10 : 0.0139    gauc : 0.9108    itemcoverage@10 : 0.0507    averagepopularity@10 : 165.0713    giniindex@10 : 0.9875    shannonentropy@10 : 0.0025    tailpercentage@10 : 0.0
Fri 10 May 2024 00:03:25 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Fri 10 May 2024 00:03:53 INFO  epoch 22 training [time: 27.60s, train loss: 567.4278]
Fri 10 May 2024 00:05:51 INFO  epoch 22 evaluating [time: 118.03s, valid_score: 0.041900]
Fri 10 May 2024 00:05:51 INFO  valid result: 
recall@10 : 0.0198    mrr@10 : 0.0419    ndcg@10 : 0.0191    hit@10 : 0.1144    map@10 : 0.008    precision@10 : 0.0133    gauc : 0.9115    itemcoverage@10 : 0.0529    averagepopularity@10 : 151.1027    giniindex@10 : 0.9863    shannonentropy@10 : 0.0024    tailpercentage@10 : 0.0
Fri 10 May 2024 00:06:19 INFO  epoch 23 training [time: 27.66s, train loss: 566.8987]
Fri 10 May 2024 00:08:17 INFO  epoch 23 evaluating [time: 118.34s, valid_score: 0.041900]
Fri 10 May 2024 00:08:17 INFO  valid result: 
recall@10 : 0.0203    mrr@10 : 0.0419    ndcg@10 : 0.0194    hit@10 : 0.1158    map@10 : 0.008    precision@10 : 0.0136    gauc : 0.9099    itemcoverage@10 : 0.0541    averagepopularity@10 : 172.3694    giniindex@10 : 0.9869    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Fri 10 May 2024 00:08:45 INFO  epoch 24 training [time: 27.98s, train loss: 566.6096]
Fri 10 May 2024 00:10:44 INFO  epoch 24 evaluating [time: 118.56s, valid_score: 0.041400]
Fri 10 May 2024 00:10:44 INFO  valid result: 
recall@10 : 0.0202    mrr@10 : 0.0414    ndcg@10 : 0.0192    hit@10 : 0.1162    map@10 : 0.0079    precision@10 : 0.0135    gauc : 0.91    itemcoverage@10 : 0.0586    averagepopularity@10 : 137.8944    giniindex@10 : 0.985    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Fri 10 May 2024 00:11:12 INFO  epoch 25 training [time: 28.05s, train loss: 566.0833]
Fri 10 May 2024 00:13:10 INFO  epoch 25 evaluating [time: 118.67s, valid_score: 0.041800]
Fri 10 May 2024 00:13:10 INFO  valid result: 
recall@10 : 0.0202    mrr@10 : 0.0418    ndcg@10 : 0.0194    hit@10 : 0.1172    map@10 : 0.008    precision@10 : 0.0138    gauc : 0.9104    itemcoverage@10 : 0.0512    averagepopularity@10 : 164.5995    giniindex@10 : 0.9872    shannonentropy@10 : 0.0024    tailpercentage@10 : 0.0
Fri 10 May 2024 00:13:37 INFO  epoch 26 training [time: 27.16s, train loss: 566.0462]
Fri 10 May 2024 00:15:36 INFO  epoch 26 evaluating [time: 118.47s, valid_score: 0.041200]
Fri 10 May 2024 00:15:36 INFO  valid result: 
recall@10 : 0.0206    mrr@10 : 0.0412    ndcg@10 : 0.0194    hit@10 : 0.117    map@10 : 0.0081    precision@10 : 0.0138    gauc : 0.9097    itemcoverage@10 : 0.0558    averagepopularity@10 : 157.2661    giniindex@10 : 0.986    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Fri 10 May 2024 00:16:04 INFO  epoch 27 training [time: 28.07s, train loss: 566.0410]
Fri 10 May 2024 00:18:02 INFO  epoch 27 evaluating [time: 118.17s, valid_score: 0.042700]
Fri 10 May 2024 00:18:02 INFO  valid result: 
recall@10 : 0.0211    mrr@10 : 0.0427    ndcg@10 : 0.02    hit@10 : 0.1178    map@10 : 0.0084    precision@10 : 0.014    gauc : 0.91    itemcoverage@10 : 0.0561    averagepopularity@10 : 166.3534    giniindex@10 : 0.9864    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Fri 10 May 2024 00:18:03 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Fri 10 May 2024 00:18:31 INFO  epoch 28 training [time: 27.92s, train loss: 565.0148]
Fri 10 May 2024 00:20:29 INFO  epoch 28 evaluating [time: 117.99s, valid_score: 0.042100]
Fri 10 May 2024 00:20:29 INFO  valid result: 
recall@10 : 0.0209    mrr@10 : 0.0421    ndcg@10 : 0.0198    hit@10 : 0.1201    map@10 : 0.0081    precision@10 : 0.0142    gauc : 0.9103    itemcoverage@10 : 0.0539    averagepopularity@10 : 177.0688    giniindex@10 : 0.987    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Fri 10 May 2024 00:20:57 INFO  epoch 29 training [time: 28.14s, train loss: 564.8931]
Fri 10 May 2024 00:22:55 INFO  epoch 29 evaluating [time: 118.26s, valid_score: 0.043300]
Fri 10 May 2024 00:22:55 INFO  valid result: 
recall@10 : 0.0209    mrr@10 : 0.0433    ndcg@10 : 0.02    hit@10 : 0.1183    map@10 : 0.0083    precision@10 : 0.014    gauc : 0.9106    itemcoverage@10 : 0.0547    averagepopularity@10 : 166.6497    giniindex@10 : 0.9865    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Fri 10 May 2024 00:22:56 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Fri 10 May 2024 00:23:23 INFO  epoch 30 training [time: 27.06s, train loss: 564.5711]
Fri 10 May 2024 00:25:21 INFO  epoch 30 evaluating [time: 118.62s, valid_score: 0.043400]
Fri 10 May 2024 00:25:21 INFO  valid result: 
recall@10 : 0.0212    mrr@10 : 0.0434    ndcg@10 : 0.0202    hit@10 : 0.1204    map@10 : 0.0084    precision@10 : 0.0142    gauc : 0.9099    itemcoverage@10 : 0.0557    averagepopularity@10 : 158.6883    giniindex@10 : 0.986    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Fri 10 May 2024 00:25:22 INFO  Saving current: saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Fri 10 May 2024 00:25:50 INFO  epoch 31 training [time: 27.77s, train loss: 564.7164]
Fri 10 May 2024 00:27:48 INFO  epoch 31 evaluating [time: 118.39s, valid_score: 0.043200]
Fri 10 May 2024 00:27:48 INFO  valid result: 
recall@10 : 0.0207    mrr@10 : 0.0432    ndcg@10 : 0.02    hit@10 : 0.1181    map@10 : 0.0084    precision@10 : 0.0141    gauc : 0.9098    itemcoverage@10 : 0.0556    averagepopularity@10 : 158.688    giniindex@10 : 0.9859    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Fri 10 May 2024 00:28:16 INFO  epoch 32 training [time: 27.80s, train loss: 564.6092]
Fri 10 May 2024 00:30:14 INFO  epoch 32 evaluating [time: 117.80s, valid_score: 0.043000]
Fri 10 May 2024 00:30:14 INFO  valid result: 
recall@10 : 0.0209    mrr@10 : 0.043    ndcg@10 : 0.02    hit@10 : 0.1201    map@10 : 0.0083    precision@10 : 0.0141    gauc : 0.9098    itemcoverage@10 : 0.0567    averagepopularity@10 : 155.1404    giniindex@10 : 0.9856    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Fri 10 May 2024 00:30:41 INFO  epoch 33 training [time: 27.71s, train loss: 564.1379]
Fri 10 May 2024 00:32:39 INFO  epoch 33 evaluating [time: 118.13s, valid_score: 0.041700]
Fri 10 May 2024 00:32:39 INFO  valid result: 
recall@10 : 0.0207    mrr@10 : 0.0417    ndcg@10 : 0.0195    hit@10 : 0.118    map@10 : 0.0081    precision@10 : 0.0138    gauc : 0.9093    itemcoverage@10 : 0.0562    averagepopularity@10 : 189.7442    giniindex@10 : 0.9869    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Fri 10 May 2024 00:33:07 INFO  epoch 34 training [time: 27.93s, train loss: 564.4173]
Fri 10 May 2024 00:35:06 INFO  epoch 34 evaluating [time: 118.49s, valid_score: 0.042900]
Fri 10 May 2024 00:35:06 INFO  valid result: 
recall@10 : 0.0204    mrr@10 : 0.0429    ndcg@10 : 0.0198    hit@10 : 0.1181    map@10 : 0.0083    precision@10 : 0.0139    gauc : 0.9099    itemcoverage@10 : 0.0566    averagepopularity@10 : 166.572    giniindex@10 : 0.9861    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Fri 10 May 2024 00:35:34 INFO  epoch 35 training [time: 27.79s, train loss: 564.0114]
Fri 10 May 2024 00:37:32 INFO  epoch 35 evaluating [time: 118.23s, valid_score: 0.042300]
Fri 10 May 2024 00:37:32 INFO  valid result: 
recall@10 : 0.0206    mrr@10 : 0.0423    ndcg@10 : 0.0196    hit@10 : 0.1186    map@10 : 0.0082    precision@10 : 0.0138    gauc : 0.9093    itemcoverage@10 : 0.0594    averagepopularity@10 : 151.8581    giniindex@10 : 0.9851    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Fri 10 May 2024 00:38:00 INFO  epoch 36 training [time: 27.96s, train loss: 563.6595]
Fri 10 May 2024 00:39:58 INFO  epoch 36 evaluating [time: 118.49s, valid_score: 0.042400]
Fri 10 May 2024 00:39:58 INFO  valid result: 
recall@10 : 0.0212    mrr@10 : 0.0424    ndcg@10 : 0.0199    hit@10 : 0.1186    map@10 : 0.0083    precision@10 : 0.0139    gauc : 0.9101    itemcoverage@10 : 0.0575    averagepopularity@10 : 162.1349    giniindex@10 : 0.9861    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Fri 10 May 2024 00:40:26 INFO  epoch 37 training [time: 27.65s, train loss: 563.2011]
Fri 10 May 2024 00:42:25 INFO  epoch 37 evaluating [time: 118.75s, valid_score: 0.042100]
Fri 10 May 2024 00:42:25 INFO  valid result: 
recall@10 : 0.0205    mrr@10 : 0.0421    ndcg@10 : 0.0197    hit@10 : 0.1167    map@10 : 0.0084    precision@10 : 0.0137    gauc : 0.9102    itemcoverage@10 : 0.0586    averagepopularity@10 : 173.007    giniindex@10 : 0.986    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Fri 10 May 2024 00:42:53 INFO  epoch 38 training [time: 27.89s, train loss: 563.1704]
Fri 10 May 2024 00:44:51 INFO  epoch 38 evaluating [time: 118.70s, valid_score: 0.042100]
Fri 10 May 2024 00:44:51 INFO  valid result: 
recall@10 : 0.021    mrr@10 : 0.0421    ndcg@10 : 0.0199    hit@10 : 0.1177    map@10 : 0.0083    precision@10 : 0.0139    gauc : 0.9093    itemcoverage@10 : 0.06    averagepopularity@10 : 156.3409    giniindex@10 : 0.985    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Fri 10 May 2024 00:45:19 INFO  epoch 39 training [time: 28.04s, train loss: 563.4666]
Fri 10 May 2024 00:47:18 INFO  epoch 39 evaluating [time: 118.32s, valid_score: 0.041000]
Fri 10 May 2024 00:47:18 INFO  valid result: 
recall@10 : 0.0204    mrr@10 : 0.041    ndcg@10 : 0.0194    hit@10 : 0.116    map@10 : 0.0082    precision@10 : 0.0136    gauc : 0.9083    itemcoverage@10 : 0.0596    averagepopularity@10 : 161.0678    giniindex@10 : 0.9851    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Fri 10 May 2024 00:47:45 INFO  epoch 40 training [time: 27.72s, train loss: 562.7435]
Fri 10 May 2024 00:49:44 INFO  epoch 40 evaluating [time: 118.66s, valid_score: 0.041800]
Fri 10 May 2024 00:49:44 INFO  valid result: 
recall@10 : 0.021    mrr@10 : 0.0418    ndcg@10 : 0.0198    hit@10 : 0.1198    map@10 : 0.0082    precision@10 : 0.0141    gauc : 0.9098    itemcoverage@10 : 0.0598    averagepopularity@10 : 147.3248    giniindex@10 : 0.9846    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Fri 10 May 2024 00:50:12 INFO  epoch 41 training [time: 27.76s, train loss: 562.7596]
Fri 10 May 2024 00:52:10 INFO  epoch 41 evaluating [time: 118.27s, valid_score: 0.041600]
Fri 10 May 2024 00:52:10 INFO  valid result: 
recall@10 : 0.0207    mrr@10 : 0.0416    ndcg@10 : 0.0196    hit@10 : 0.1187    map@10 : 0.0082    precision@10 : 0.014    gauc : 0.9107    itemcoverage@10 : 0.0584    averagepopularity@10 : 156.8922    giniindex@10 : 0.9853    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Fri 10 May 2024 00:52:10 INFO  Finished training, best eval result in epoch 30
Fri 10 May 2024 00:52:10 INFO  Loading model structure and parameters from saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
Fri 10 May 2024 00:54:11 INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |    13.20 %     |
+-------------+----------------+
| GPU         | 3.54 G/11.93 G |
+-------------+----------------+
| Memory      | 2.52 G/31.23 G |
+-------------+----------------+
Fri 10 May 2024 00:54:11 INFO  best valid : OrderedDict([('recall@10', 0.0212), ('mrr@10', 0.0434), ('ndcg@10', 0.0202), ('hit@10', 0.1204), ('map@10', 0.0084), ('precision@10', 0.0142), ('gauc', 0.9099), ('itemcoverage@10', 0.0557), ('averagepopularity@10', 158.6883), ('giniindex@10', 0.986), ('shannonentropy@10', 0.0023), ('tailpercentage@10', 0.0)])
Fri 10 May 2024 00:54:11 INFO  test result: OrderedDict([('recall@10', 0.0216), ('mrr@10', 0.045), ('ndcg@10', 0.0208), ('hit@10', 0.1235), ('map@10', 0.0087), ('precision@10', 0.0144), ('gauc', 0.9092), ('itemcoverage@10', 0.057), ('averagepopularity@10', 158.1008), ('giniindex@10', 0.9858), ('shannonentropy@10', 0.0022), ('tailpercentage@10', 0.0)])
Fri 10 May 2024 00:54:11 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/amazon_books_60core_kg
checkpoint_dir = saved/amazon_books_60core_kg/DMF
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
inter_matrix_type = 01
user_embedding_size = 64
item_embedding_size = 64
user_hidden_size_list = [64, 64]
item_hidden_size_list = [64, 64]
embedding_size = 10
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.GENERAL
encoding = utf-8
device = cuda:1
my_log_file = /home/fontana/Tesi/log/carbon_default.log
max_emission_step = -1
MODEL_INPUT_TYPE = InputType.POINTWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Fri 10 May 2024 00:54:18 INFO  amazon_books_60core_kg
The number of users: 22156
Average actions of users: 66.16434213495825
The number of items: 54459
Average actions of items: 26.917459326453415
The number of inters: 1465871
The sparsity of the dataset: 99.87851162187994%
Remain Fields: ['user_id', 'item_id']
Fri 10 May 2024 00:54:23 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Fri 10 May 2024 00:54:23 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Fri 10 May 2024 00:54:30 INFO  Loading model structure and parameters from saved/amazon_books_60core_kg/DMF/DMF-May-09-2024_23-09-45.pth
