Mon 15 Apr 2024 20:57:05 INFO  ['src/default_tracker.py', '--dataset=ml-10m_core5', '--model=KGCN']
Mon 15 Apr 2024 20:57:05 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/ml-10m_core5
checkpoint_dir = saved/ml-10m_core5/KGCN
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
embedding_size = 64
n_iter = 1
aggregator = sum
reg_weight = 1e-07
neighbor_sample_size = 4
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.KNOWLEDGE
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.PAIRWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Mon 15 Apr 2024 20:57:41 INFO  ml-10m_core5
The number of users: 69879
Average actions of users: 142.9866338475629
The number of items: 10133
Average actions of items: 986.1448874851955
The number of inters: 9991620
The sparsity of the dataset: 98.58892146803161%
Remain Fields: ['entity_id', 'user_id', 'item_id', 'rating', 'head_id', 'relation_id', 'tail_id']
The number of entities: 177874
The number of relations: 33
The number of triples: 531224
The number of items that have been linked to KG: 10132
Mon 15 Apr 2024 20:58:16 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Mon 15 Apr 2024 20:58:16 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Mon 15 Apr 2024 20:58:24 INFO  KGCN(
  (user_embedding): Embedding(69879, 64)
  (entity_embedding): Embedding(177874, 64)
  (relation_embedding): Embedding(34, 64)
  (softmax): Softmax(dim=-1)
  (linear_layers): ModuleList(
    (0): Linear(in_features=64, out_features=64, bias=True)
  )
  (ReLU): ReLU()
  (Tanh): Tanh()
  (bce_loss): BCEWithLogitsLoss()
  (l2_loss): EmbLoss()
)
Trainable parameters: 15862528
Mon 15 Apr 2024 20:58:31 INFO  FLOPs: 4747.0
Mon 15 Apr 2024 21:00:53 INFO  epoch 0 training [time: 108.85s, train loss: 1492.3313]
Mon 15 Apr 2024 21:09:36 INFO  epoch 0 evaluating [time: 522.96s, valid_score: 0.223900]
Mon 15 Apr 2024 21:09:36 INFO  valid result: 
recall@10 : 0.101    mrr@10 : 0.2239    ndcg@10 : 0.1214    hit@10 : 0.4864    map@10 : 0.0604    precision@10 : 0.0904    gauc : 0.9245    itemcoverage@10 : 0.0644    averagepopularity@10 : 21587.8059    giniindex@10 : 0.9969    shannonentropy@10 : 0.0057    tailpercentage@10 : 0.0
Mon 15 Apr 2024 21:09:38 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 21:11:23 INFO  epoch 1 training [time: 104.71s, train loss: 1221.0733]
Mon 15 Apr 2024 21:20:00 INFO  epoch 1 evaluating [time: 517.29s, valid_score: 0.247200]
Mon 15 Apr 2024 21:20:00 INFO  valid result: 
recall@10 : 0.1167    mrr@10 : 0.2472    ndcg@10 : 0.1389    hit@10 : 0.5212    map@10 : 0.0715    precision@10 : 0.103    gauc : 0.939    itemcoverage@10 : 0.0815    averagepopularity@10 : 19417.7833    giniindex@10 : 0.9945    shannonentropy@10 : 0.0052    tailpercentage@10 : 0.0
Mon 15 Apr 2024 21:20:02 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 21:21:45 INFO  epoch 2 training [time: 103.66s, train loss: 1102.0078]
Mon 15 Apr 2024 21:30:20 INFO  epoch 2 evaluating [time: 514.82s, valid_score: 0.262100]
Mon 15 Apr 2024 21:30:20 INFO  valid result: 
recall@10 : 0.1208    mrr@10 : 0.2621    ndcg@10 : 0.1463    hit@10 : 0.5453    map@10 : 0.075    precision@10 : 0.1096    gauc : 0.9475    itemcoverage@10 : 0.1516    averagepopularity@10 : 16929.2505    giniindex@10 : 0.9898    shannonentropy@10 : 0.0032    tailpercentage@10 : 0.0
Mon 15 Apr 2024 21:30:22 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 21:32:08 INFO  epoch 3 training [time: 106.52s, train loss: 1028.9797]
Mon 15 Apr 2024 21:40:43 INFO  epoch 3 evaluating [time: 514.98s, valid_score: 0.279500]
Mon 15 Apr 2024 21:40:43 INFO  valid result: 
recall@10 : 0.1283    mrr@10 : 0.2795    ndcg@10 : 0.1559    hit@10 : 0.5711    map@10 : 0.0805    precision@10 : 0.1162    gauc : 0.9517    itemcoverage@10 : 0.1945    averagepopularity@10 : 16410.8731    giniindex@10 : 0.9868    shannonentropy@10 : 0.0026    tailpercentage@10 : 0.0
Mon 15 Apr 2024 21:40:45 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 21:42:29 INFO  epoch 4 training [time: 104.41s, train loss: 982.9780]
Mon 15 Apr 2024 21:51:05 INFO  epoch 4 evaluating [time: 515.92s, valid_score: 0.295100]
Mon 15 Apr 2024 21:51:05 INFO  valid result: 
recall@10 : 0.1385    mrr@10 : 0.2951    ndcg@10 : 0.1668    hit@10 : 0.5951    map@10 : 0.0872    precision@10 : 0.1238    gauc : 0.9544    itemcoverage@10 : 0.2326    averagepopularity@10 : 15659.9596    giniindex@10 : 0.9826    shannonentropy@10 : 0.0022    tailpercentage@10 : 0.0
Mon 15 Apr 2024 21:51:07 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 21:52:52 INFO  epoch 5 training [time: 104.62s, train loss: 947.4700]
Mon 15 Apr 2024 22:01:31 INFO  epoch 5 evaluating [time: 518.84s, valid_score: 0.311800]
Mon 15 Apr 2024 22:01:31 INFO  valid result: 
recall@10 : 0.1511    mrr@10 : 0.3118    ndcg@10 : 0.1783    hit@10 : 0.6215    map@10 : 0.0944    precision@10 : 0.1296    gauc : 0.9562    itemcoverage@10 : 0.2606    averagepopularity@10 : 14653.5143    giniindex@10 : 0.9776    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Mon 15 Apr 2024 22:01:33 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 22:03:18 INFO  epoch 6 training [time: 105.29s, train loss: 918.9584]
Mon 15 Apr 2024 22:11:54 INFO  epoch 6 evaluating [time: 515.73s, valid_score: 0.314800]
Mon 15 Apr 2024 22:11:54 INFO  valid result: 
recall@10 : 0.1568    mrr@10 : 0.3148    ndcg@10 : 0.1819    hit@10 : 0.6316    map@10 : 0.0964    precision@10 : 0.1314    gauc : 0.9575    itemcoverage@10 : 0.2782    averagepopularity@10 : 13877.4295    giniindex@10 : 0.9737    shannonentropy@10 : 0.002    tailpercentage@10 : 0.0
Mon 15 Apr 2024 22:11:55 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 22:13:40 INFO  epoch 7 training [time: 104.45s, train loss: 894.4729]
Mon 15 Apr 2024 22:22:17 INFO  epoch 7 evaluating [time: 516.95s, valid_score: 0.320400]
Mon 15 Apr 2024 22:22:17 INFO  valid result: 
recall@10 : 0.1603    mrr@10 : 0.3204    ndcg@10 : 0.1858    hit@10 : 0.6394    map@10 : 0.0991    precision@10 : 0.1333    gauc : 0.9584    itemcoverage@10 : 0.2927    averagepopularity@10 : 13297.1107    giniindex@10 : 0.9709    shannonentropy@10 : 0.002    tailpercentage@10 : 0.0
Mon 15 Apr 2024 22:22:19 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 22:24:04 INFO  epoch 8 training [time: 104.90s, train loss: 875.2455]
Mon 15 Apr 2024 22:32:41 INFO  epoch 8 evaluating [time: 517.48s, valid_score: 0.324900]
Mon 15 Apr 2024 22:32:41 INFO  valid result: 
recall@10 : 0.1644    mrr@10 : 0.3249    ndcg@10 : 0.1898    hit@10 : 0.6456    map@10 : 0.1019    precision@10 : 0.1357    gauc : 0.959    itemcoverage@10 : 0.3039    averagepopularity@10 : 13439.2533    giniindex@10 : 0.9694    shannonentropy@10 : 0.0019    tailpercentage@10 : 0.0
Mon 15 Apr 2024 22:32:43 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 22:34:28 INFO  epoch 9 training [time: 105.03s, train loss: 858.2048]
Mon 15 Apr 2024 22:43:05 INFO  epoch 9 evaluating [time: 517.19s, valid_score: 0.320500]
Mon 15 Apr 2024 22:43:05 INFO  valid result: 
recall@10 : 0.164    mrr@10 : 0.3205    ndcg@10 : 0.1883    hit@10 : 0.6441    map@10 : 0.101    precision@10 : 0.1348    gauc : 0.9594    itemcoverage@10 : 0.3309    averagepopularity@10 : 12308.2152    giniindex@10 : 0.9638    shannonentropy@10 : 0.0018    tailpercentage@10 : 0.0
Mon 15 Apr 2024 22:44:48 INFO  epoch 10 training [time: 103.22s, train loss: 844.0806]
Mon 15 Apr 2024 22:53:18 INFO  epoch 10 evaluating [time: 509.79s, valid_score: 0.324800]
Mon 15 Apr 2024 22:53:18 INFO  valid result: 
recall@10 : 0.1662    mrr@10 : 0.3248    ndcg@10 : 0.1907    hit@10 : 0.6506    map@10 : 0.1023    precision@10 : 0.1364    gauc : 0.9598    itemcoverage@10 : 0.34    averagepopularity@10 : 12384.3812    giniindex@10 : 0.9624    shannonentropy@10 : 0.0018    tailpercentage@10 : 0.0
Mon 15 Apr 2024 22:55:01 INFO  epoch 11 training [time: 103.07s, train loss: 831.5705]
Mon 15 Apr 2024 23:03:39 INFO  epoch 11 evaluating [time: 517.60s, valid_score: 0.321300]
Mon 15 Apr 2024 23:03:39 INFO  valid result: 
recall@10 : 0.1663    mrr@10 : 0.3213    ndcg@10 : 0.1893    hit@10 : 0.6498    map@10 : 0.1012    precision@10 : 0.1357    gauc : 0.9599    itemcoverage@10 : 0.3509    averagepopularity@10 : 12025.1813    giniindex@10 : 0.9599    shannonentropy@10 : 0.0017    tailpercentage@10 : 0.0
Mon 15 Apr 2024 23:05:22 INFO  epoch 12 training [time: 102.84s, train loss: 820.9105]
Mon 15 Apr 2024 23:13:57 INFO  epoch 12 evaluating [time: 515.16s, valid_score: 0.326100]
Mon 15 Apr 2024 23:13:57 INFO  valid result: 
recall@10 : 0.1687    mrr@10 : 0.3261    ndcg@10 : 0.1919    hit@10 : 0.6541    map@10 : 0.1028    precision@10 : 0.1372    gauc : 0.9601    itemcoverage@10 : 0.361    averagepopularity@10 : 12362.2942    giniindex@10 : 0.9603    shannonentropy@10 : 0.0017    tailpercentage@10 : 0.0
Mon 15 Apr 2024 23:13:58 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 23:15:42 INFO  epoch 13 training [time: 103.66s, train loss: 810.2539]
Mon 15 Apr 2024 23:24:16 INFO  epoch 13 evaluating [time: 514.48s, valid_score: 0.326700]
Mon 15 Apr 2024 23:24:16 INFO  valid result: 
recall@10 : 0.1706    mrr@10 : 0.3267    ndcg@10 : 0.1937    hit@10 : 0.6565    map@10 : 0.104    precision@10 : 0.1391    gauc : 0.9603    itemcoverage@10 : 0.3678    averagepopularity@10 : 12158.02    giniindex@10 : 0.9586    shannonentropy@10 : 0.0017    tailpercentage@10 : 0.0
Mon 15 Apr 2024 23:24:18 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Mon 15 Apr 2024 23:26:02 INFO  epoch 14 training [time: 104.05s, train loss: 801.6520]
Mon 15 Apr 2024 23:34:43 INFO  epoch 14 evaluating [time: 520.50s, valid_score: 0.322000]
Mon 15 Apr 2024 23:34:43 INFO  valid result: 
recall@10 : 0.1678    mrr@10 : 0.322    ndcg@10 : 0.1899    hit@10 : 0.6537    map@10 : 0.1012    precision@10 : 0.1364    gauc : 0.9603    itemcoverage@10 : 0.3906    averagepopularity@10 : 11523.056    giniindex@10 : 0.9536    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Mon 15 Apr 2024 23:36:26 INFO  epoch 15 training [time: 103.69s, train loss: 793.4543]
Mon 15 Apr 2024 23:45:04 INFO  epoch 15 evaluating [time: 517.38s, valid_score: 0.324300]
Mon 15 Apr 2024 23:45:04 INFO  valid result: 
recall@10 : 0.1714    mrr@10 : 0.3243    ndcg@10 : 0.1926    hit@10 : 0.6582    map@10 : 0.1029    precision@10 : 0.1383    gauc : 0.9604    itemcoverage@10 : 0.3916    averagepopularity@10 : 11857.8486    giniindex@10 : 0.9545    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Mon 15 Apr 2024 23:46:48 INFO  epoch 16 training [time: 103.92s, train loss: 786.3459]
Mon 15 Apr 2024 23:55:23 INFO  epoch 16 evaluating [time: 515.60s, valid_score: 0.325000]
Mon 15 Apr 2024 23:55:23 INFO  valid result: 
recall@10 : 0.1704    mrr@10 : 0.325    ndcg@10 : 0.1926    hit@10 : 0.6586    map@10 : 0.1032    precision@10 : 0.1376    gauc : 0.9605    itemcoverage@10 : 0.3993    averagepopularity@10 : 11662.7321    giniindex@10 : 0.9531    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Mon 15 Apr 2024 23:57:07 INFO  epoch 17 training [time: 103.30s, train loss: 778.9385]
Tue 16 Apr 2024 00:05:44 INFO  epoch 17 evaluating [time: 517.86s, valid_score: 0.326700]
Tue 16 Apr 2024 00:05:44 INFO  valid result: 
recall@10 : 0.1722    mrr@10 : 0.3267    ndcg@10 : 0.1939    hit@10 : 0.6608    map@10 : 0.1037    precision@10 : 0.139    gauc : 0.9605    itemcoverage@10 : 0.409    averagepopularity@10 : 11699.7909    giniindex@10 : 0.9526    shannonentropy@10 : 0.0015    tailpercentage@10 : 0.0
Tue 16 Apr 2024 00:05:47 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Tue 16 Apr 2024 00:07:32 INFO  epoch 18 training [time: 104.79s, train loss: 773.4855]
Tue 16 Apr 2024 00:16:09 INFO  epoch 18 evaluating [time: 517.31s, valid_score: 0.323800]
Tue 16 Apr 2024 00:16:09 INFO  valid result: 
recall@10 : 0.1717    mrr@10 : 0.3238    ndcg@10 : 0.1922    hit@10 : 0.6587    map@10 : 0.1025    precision@10 : 0.138    gauc : 0.9606    itemcoverage@10 : 0.4139    averagepopularity@10 : 11246.8649    giniindex@10 : 0.9505    shannonentropy@10 : 0.0015    tailpercentage@10 : 0.0
Tue 16 Apr 2024 00:17:53 INFO  epoch 19 training [time: 103.54s, train loss: 766.8316]
Tue 16 Apr 2024 00:26:28 INFO  epoch 19 evaluating [time: 515.18s, valid_score: 0.328700]
Tue 16 Apr 2024 00:26:28 INFO  valid result: 
recall@10 : 0.1731    mrr@10 : 0.3287    ndcg@10 : 0.1948    hit@10 : 0.6618    map@10 : 0.1047    precision@10 : 0.1386    gauc : 0.9606    itemcoverage@10 : 0.4225    averagepopularity@10 : 11394.4176    giniindex@10 : 0.9495    shannonentropy@10 : 0.0015    tailpercentage@10 : 0.0
Tue 16 Apr 2024 00:26:30 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Tue 16 Apr 2024 00:28:13 INFO  epoch 20 training [time: 103.21s, train loss: 761.8867]
Tue 16 Apr 2024 00:36:54 INFO  epoch 20 evaluating [time: 521.50s, valid_score: 0.326700]
Tue 16 Apr 2024 00:36:54 INFO  valid result: 
recall@10 : 0.1736    mrr@10 : 0.3267    ndcg@10 : 0.1948    hit@10 : 0.661    map@10 : 0.1045    precision@10 : 0.1394    gauc : 0.9607    itemcoverage@10 : 0.4251    averagepopularity@10 : 11037.3464    giniindex@10 : 0.9481    shannonentropy@10 : 0.0015    tailpercentage@10 : 0.0
Tue 16 Apr 2024 00:38:38 INFO  epoch 21 training [time: 103.57s, train loss: 757.9453]
Tue 16 Apr 2024 00:47:10 INFO  epoch 21 evaluating [time: 512.24s, valid_score: 0.325100]
Tue 16 Apr 2024 00:47:10 INFO  valid result: 
recall@10 : 0.1717    mrr@10 : 0.3251    ndcg@10 : 0.1927    hit@10 : 0.6588    map@10 : 0.1029    precision@10 : 0.1381    gauc : 0.9606    itemcoverage@10 : 0.4419    averagepopularity@10 : 10727.3481    giniindex@10 : 0.9448    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 00:48:53 INFO  epoch 22 training [time: 102.29s, train loss: 751.8706]
Tue 16 Apr 2024 00:57:25 INFO  epoch 22 evaluating [time: 512.48s, valid_score: 0.325000]
Tue 16 Apr 2024 00:57:25 INFO  valid result: 
recall@10 : 0.1737    mrr@10 : 0.325    ndcg@10 : 0.1935    hit@10 : 0.662    map@10 : 0.1034    precision@10 : 0.1385    gauc : 0.9606    itemcoverage@10 : 0.4465    averagepopularity@10 : 10745.5271    giniindex@10 : 0.9449    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 00:59:07 INFO  epoch 23 training [time: 101.79s, train loss: 746.6169]
Tue 16 Apr 2024 01:07:39 INFO  epoch 23 evaluating [time: 512.52s, valid_score: 0.327900]
Tue 16 Apr 2024 01:07:39 INFO  valid result: 
recall@10 : 0.1748    mrr@10 : 0.3279    ndcg@10 : 0.1952    hit@10 : 0.6643    map@10 : 0.1045    precision@10 : 0.1394    gauc : 0.9606    itemcoverage@10 : 0.4474    averagepopularity@10 : 10848.9547    giniindex@10 : 0.9442    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 01:09:22 INFO  epoch 24 training [time: 102.66s, train loss: 742.7871]
Tue 16 Apr 2024 01:17:53 INFO  epoch 24 evaluating [time: 511.28s, valid_score: 0.328600]
Tue 16 Apr 2024 01:17:53 INFO  valid result: 
recall@10 : 0.1759    mrr@10 : 0.3286    ndcg@10 : 0.1964    hit@10 : 0.6661    map@10 : 0.1056    precision@10 : 0.14    gauc : 0.9607    itemcoverage@10 : 0.4489    averagepopularity@10 : 10743.5865    giniindex@10 : 0.9431    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 01:19:36 INFO  epoch 25 training [time: 102.88s, train loss: 738.4640]
Tue 16 Apr 2024 01:28:06 INFO  epoch 25 evaluating [time: 509.71s, valid_score: 0.325600]
Tue 16 Apr 2024 01:28:06 INFO  valid result: 
recall@10 : 0.1749    mrr@10 : 0.3256    ndcg@10 : 0.1947    hit@10 : 0.6629    map@10 : 0.1045    precision@10 : 0.1385    gauc : 0.9606    itemcoverage@10 : 0.4617    averagepopularity@10 : 10486.6712    giniindex@10 : 0.9396    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 01:29:50 INFO  epoch 26 training [time: 103.81s, train loss: 735.6522]
Tue 16 Apr 2024 01:38:23 INFO  epoch 26 evaluating [time: 513.65s, valid_score: 0.334200]
Tue 16 Apr 2024 01:38:23 INFO  valid result: 
recall@10 : 0.1775    mrr@10 : 0.3342    ndcg@10 : 0.1989    hit@10 : 0.6712    map@10 : 0.1074    precision@10 : 0.1408    gauc : 0.9608    itemcoverage@10 : 0.4507    averagepopularity@10 : 10983.407    giniindex@10 : 0.9444    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 01:38:25 INFO  Saving current: saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Tue 16 Apr 2024 01:40:11 INFO  epoch 27 training [time: 105.98s, train loss: 730.6086]
Tue 16 Apr 2024 01:48:46 INFO  epoch 27 evaluating [time: 515.46s, valid_score: 0.326400]
Tue 16 Apr 2024 01:48:46 INFO  valid result: 
recall@10 : 0.1756    mrr@10 : 0.3264    ndcg@10 : 0.1954    hit@10 : 0.6657    map@10 : 0.1048    precision@10 : 0.1394    gauc : 0.9607    itemcoverage@10 : 0.4643    averagepopularity@10 : 10536.8034    giniindex@10 : 0.9409    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 01:50:28 INFO  epoch 28 training [time: 102.05s, train loss: 727.4751]
Tue 16 Apr 2024 01:59:04 INFO  epoch 28 evaluating [time: 515.79s, valid_score: 0.322900]
Tue 16 Apr 2024 01:59:04 INFO  valid result: 
recall@10 : 0.1716    mrr@10 : 0.3229    ndcg@10 : 0.1917    hit@10 : 0.6611    map@10 : 0.1022    precision@10 : 0.137    gauc : 0.9607    itemcoverage@10 : 0.4715    averagepopularity@10 : 10171.6984    giniindex@10 : 0.9368    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 02:00:46 INFO  epoch 29 training [time: 102.02s, train loss: 724.3674]
Tue 16 Apr 2024 02:09:23 INFO  epoch 29 evaluating [time: 516.52s, valid_score: 0.324100]
Tue 16 Apr 2024 02:09:23 INFO  valid result: 
recall@10 : 0.175    mrr@10 : 0.3241    ndcg@10 : 0.1936    hit@10 : 0.6648    map@10 : 0.1036    precision@10 : 0.1377    gauc : 0.9607    itemcoverage@10 : 0.4718    averagepopularity@10 : 10179.7306    giniindex@10 : 0.9368    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 02:11:04 INFO  epoch 30 training [time: 101.71s, train loss: 721.4651]
Tue 16 Apr 2024 02:19:38 INFO  epoch 30 evaluating [time: 513.30s, valid_score: 0.328000]
Tue 16 Apr 2024 02:19:38 INFO  valid result: 
recall@10 : 0.1765    mrr@10 : 0.328    ndcg@10 : 0.1962    hit@10 : 0.6686    map@10 : 0.1053    precision@10 : 0.1396    gauc : 0.9608    itemcoverage@10 : 0.4783    averagepopularity@10 : 10421.7884    giniindex@10 : 0.9376    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 02:21:20 INFO  epoch 31 training [time: 102.46s, train loss: 718.3737]
Tue 16 Apr 2024 02:29:56 INFO  epoch 31 evaluating [time: 516.05s, valid_score: 0.330300]
Tue 16 Apr 2024 02:29:56 INFO  valid result: 
recall@10 : 0.1781    mrr@10 : 0.3303    ndcg@10 : 0.1975    hit@10 : 0.6708    map@10 : 0.1062    precision@10 : 0.1401    gauc : 0.9608    itemcoverage@10 : 0.4805    averagepopularity@10 : 10497.555    giniindex@10 : 0.938    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 02:31:38 INFO  epoch 32 training [time: 102.20s, train loss: 715.4319]
Tue 16 Apr 2024 02:40:13 INFO  epoch 32 evaluating [time: 514.62s, valid_score: 0.327400]
Tue 16 Apr 2024 02:40:13 INFO  valid result: 
recall@10 : 0.177    mrr@10 : 0.3274    ndcg@10 : 0.196    hit@10 : 0.6691    map@10 : 0.105    precision@10 : 0.1397    gauc : 0.9608    itemcoverage@10 : 0.483    averagepopularity@10 : 10141.3678    giniindex@10 : 0.9365    shannonentropy@10 : 0.0014    tailpercentage@10 : 0.0
Tue 16 Apr 2024 02:41:55 INFO  epoch 33 training [time: 102.01s, train loss: 712.9920]
Tue 16 Apr 2024 02:50:28 INFO  epoch 33 evaluating [time: 513.07s, valid_score: 0.323600]
Tue 16 Apr 2024 02:50:28 INFO  valid result: 
recall@10 : 0.1759    mrr@10 : 0.3236    ndcg@10 : 0.1943    hit@10 : 0.6668    map@10 : 0.104    precision@10 : 0.1384    gauc : 0.9608    itemcoverage@10 : 0.4911    averagepopularity@10 : 9785.9064    giniindex@10 : 0.9327    shannonentropy@10 : 0.0013    tailpercentage@10 : 0.0
Tue 16 Apr 2024 02:52:10 INFO  epoch 34 training [time: 101.99s, train loss: 709.7203]
Tue 16 Apr 2024 03:00:48 INFO  epoch 34 evaluating [time: 518.15s, valid_score: 0.326000]
Tue 16 Apr 2024 03:00:48 INFO  valid result: 
recall@10 : 0.1773    mrr@10 : 0.326    ndcg@10 : 0.1954    hit@10 : 0.6672    map@10 : 0.105    precision@10 : 0.138    gauc : 0.9606    itemcoverage@10 : 0.4982    averagepopularity@10 : 9858.6843    giniindex@10 : 0.9322    shannonentropy@10 : 0.0013    tailpercentage@10 : 0.0
Tue 16 Apr 2024 03:02:31 INFO  epoch 35 training [time: 103.02s, train loss: 707.5052]
Tue 16 Apr 2024 03:11:03 INFO  epoch 35 evaluating [time: 512.26s, valid_score: 0.329800]
Tue 16 Apr 2024 03:11:03 INFO  valid result: 
recall@10 : 0.179    mrr@10 : 0.3298    ndcg@10 : 0.1981    hit@10 : 0.67    map@10 : 0.1067    precision@10 : 0.1406    gauc : 0.9609    itemcoverage@10 : 0.4912    averagepopularity@10 : 10246.7679    giniindex@10 : 0.9353    shannonentropy@10 : 0.0013    tailpercentage@10 : 0.0
Tue 16 Apr 2024 03:12:47 INFO  epoch 36 training [time: 103.64s, train loss: 704.2985]
Tue 16 Apr 2024 03:21:22 INFO  epoch 36 evaluating [time: 514.62s, valid_score: 0.327700]
Tue 16 Apr 2024 03:21:22 INFO  valid result: 
recall@10 : 0.179    mrr@10 : 0.3277    ndcg@10 : 0.1969    hit@10 : 0.6701    map@10 : 0.1059    precision@10 : 0.1395    gauc : 0.9608    itemcoverage@10 : 0.503    averagepopularity@10 : 10033.8454    giniindex@10 : 0.9327    shannonentropy@10 : 0.0013    tailpercentage@10 : 0.0
Tue 16 Apr 2024 03:23:05 INFO  epoch 37 training [time: 103.14s, train loss: 702.5101]
Tue 16 Apr 2024 03:31:45 INFO  epoch 37 evaluating [time: 520.18s, valid_score: 0.328100]
Tue 16 Apr 2024 03:31:45 INFO  valid result: 
recall@10 : 0.1791    mrr@10 : 0.3281    ndcg@10 : 0.1969    hit@10 : 0.6718    map@10 : 0.1056    precision@10 : 0.1396    gauc : 0.9607    itemcoverage@10 : 0.5099    averagepopularity@10 : 10040.0249    giniindex@10 : 0.9316    shannonentropy@10 : 0.0013    tailpercentage@10 : 0.0
Tue 16 Apr 2024 03:31:45 INFO  Finished training, best eval result in epoch 26
Tue 16 Apr 2024 03:31:48 INFO  Loading model structure and parameters from saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
Tue 16 Apr 2024 03:40:35 INFO  The running environment of this training is as follows:
+-------------+----------------+
| Environment |     Usage      |
+=============+================+
| CPU         |     6.80 %     |
+-------------+----------------+
| GPU         | 0.52 G/15.57 G |
+-------------+----------------+
| Memory      | 4.03 G/27.41 G |
+-------------+----------------+
Tue 16 Apr 2024 03:40:35 INFO  best valid : OrderedDict([('recall@10', 0.1775), ('mrr@10', 0.3342), ('ndcg@10', 0.1989), ('hit@10', 0.6712), ('map@10', 0.1074), ('precision@10', 0.1408), ('gauc', 0.9608), ('itemcoverage@10', 0.4507), ('averagepopularity@10', 10983.407), ('giniindex@10', 0.9444), ('shannonentropy@10', 0.0014), ('tailpercentage@10', 0.0)])
Tue 16 Apr 2024 03:40:35 INFO  test result: OrderedDict([('recall@10', 0.1985), ('mrr@10', 0.3962), ('ndcg@10', 0.2443), ('hit@10', 0.6945), ('map@10', 0.147), ('precision@10', 0.1731), ('gauc', 0.963), ('itemcoverage@10', 0.4638), ('averagepopularity@10', 10567.33), ('giniindex@10', 0.9403), ('shannonentropy@10', 0.0014), ('tailpercentage@10', 0.0)])
Tue 16 Apr 2024 03:40:39 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/ml-10m_core5
checkpoint_dir = saved/ml-10m_core5/KGCN
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
embedding_size = 64
n_iter = 1
aggregator = sum
reg_weight = 1e-07
neighbor_sample_size = 4
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.KNOWLEDGE
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.PAIRWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Tue 16 Apr 2024 03:41:18 INFO  ml-10m_core5
The number of users: 69879
Average actions of users: 142.9866338475629
The number of items: 10133
Average actions of items: 986.1448874851955
The number of inters: 9991620
The sparsity of the dataset: 98.58892146803161%
Remain Fields: ['entity_id', 'user_id', 'item_id', 'rating', 'head_id', 'relation_id', 'tail_id']
The number of entities: 177874
The number of relations: 33
The number of triples: 531224
The number of items that have been linked to KG: 10132
Tue 16 Apr 2024 03:41:50 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Tue 16 Apr 2024 03:41:50 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Tue 16 Apr 2024 03:42:00 INFO  Loading model structure and parameters from saved/ml-10m_core5/KGCN/KGCN-Apr-15-2024_20-58-32.pth
