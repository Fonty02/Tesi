Wed 17 Apr 2024 03:50:25 INFO  ['src/default_tracker.py', '--dataset=ml-10m_50U10I', '--model=KGNNLS']
Wed 17 Apr 2024 03:50:25 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/ml-10m_50U10I
checkpoint_dir = saved/ml-10m_50U10I/KGNNLS
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
embedding_size = 64
n_iter = 1
aggregator = sum
reg_weight = 1e-07
neighbor_sample_size = 4
ls_weight = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.KNOWLEDGE
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.PAIRWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Wed 17 Apr 2024 03:50:52 INFO  ml-10m_50U10I
The number of users: 50001
Average actions of users: 140.97052
The number of items: 9938
Average actions of items: 709.3213243433632
The number of inters: 7048526
The sparsity of the dataset: 98.58152847005447%
Remain Fields: ['entity_id', 'user_id', 'item_id', 'rating', 'head_id', 'relation_id', 'tail_id']
The number of entities: 175647
The number of relations: 33
The number of triples: 521125
The number of items that have been linked to KG: 9937
Wed 17 Apr 2024 03:51:14 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Wed 17 Apr 2024 03:51:14 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Wed 17 Apr 2024 03:51:38 INFO  KGNNLS(
  (user_embedding): Embedding(50001, 64)
  (entity_embedding): Embedding(175647, 64)
  (relation_embedding): Embedding(34, 64)
  (softmax): Softmax(dim=-1)
  (linear_layers): ModuleList(
    (0): Linear(in_features=64, out_features=64, bias=True)
  )
  (ReLU): ReLU()
  (Tanh): Tanh()
  (bce_loss): BCEWithLogitsLoss()
  (l2_loss): EmbLoss()
)
Trainable parameters: 14447808
Wed 17 Apr 2024 03:51:59 INFO  FLOPs: 4747.0
Wed 17 Apr 2024 03:54:32 INFO  epoch 0 training [time: 116.44s, train loss: 2045.9224]
Wed 17 Apr 2024 04:00:26 INFO  epoch 0 evaluating [time: 354.20s, valid_score: 0.219400]
Wed 17 Apr 2024 04:00:26 INFO  valid result: 
recall@10 : 0.094    mrr@10 : 0.2194    ndcg@10 : 0.1165    hit@10 : 0.4679    map@10 : 0.058    precision@10 : 0.0864    gauc : 0.9165    itemcoverage@10 : 0.0334    averagepopularity@10 : 15964.9415    giniindex@10 : 0.9977    shannonentropy@10 : 0.0102    tailpercentage@10 : 0.0001
Wed 17 Apr 2024 04:00:28 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:02:25 INFO  epoch 1 training [time: 116.78s, train loss: 1873.7997]
Wed 17 Apr 2024 04:08:19 INFO  epoch 1 evaluating [time: 353.50s, valid_score: 0.238400]
Wed 17 Apr 2024 04:08:19 INFO  valid result: 
recall@10 : 0.1133    mrr@10 : 0.2384    ndcg@10 : 0.1333    hit@10 : 0.5064    map@10 : 0.0684    precision@10 : 0.0974    gauc : 0.9335    itemcoverage@10 : 0.0586    averagepopularity@10 : 14664.5079    giniindex@10 : 0.9959    shannonentropy@10 : 0.0068    tailpercentage@10 : 0.0
Wed 17 Apr 2024 04:08:20 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:10:19 INFO  epoch 2 training [time: 118.87s, train loss: 1771.7789]
Wed 17 Apr 2024 04:16:08 INFO  epoch 2 evaluating [time: 349.22s, valid_score: 0.252000]
Wed 17 Apr 2024 04:16:08 INFO  valid result: 
recall@10 : 0.1175    mrr@10 : 0.252    ndcg@10 : 0.1403    hit@10 : 0.5256    map@10 : 0.0723    precision@10 : 0.1031    gauc : 0.9423    itemcoverage@10 : 0.0911    averagepopularity@10 : 12787.4009    giniindex@10 : 0.9923    shannonentropy@10 : 0.0051    tailpercentage@10 : 0.0
Wed 17 Apr 2024 04:16:10 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:18:05 INFO  epoch 3 training [time: 114.83s, train loss: 1727.9693]
Wed 17 Apr 2024 04:23:59 INFO  epoch 3 evaluating [time: 354.67s, valid_score: 0.264000]
Wed 17 Apr 2024 04:23:59 INFO  valid result: 
recall@10 : 0.1222    mrr@10 : 0.264    ndcg@10 : 0.1473    hit@10 : 0.5444    map@10 : 0.076    precision@10 : 0.1091    gauc : 0.9474    itemcoverage@10 : 0.1364    averagepopularity@10 : 12393.5326    giniindex@10 : 0.9904    shannonentropy@10 : 0.0035    tailpercentage@10 : 0.0
Wed 17 Apr 2024 04:24:01 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:25:56 INFO  epoch 4 training [time: 114.89s, train loss: 1690.2533]
Wed 17 Apr 2024 04:31:46 INFO  epoch 4 evaluating [time: 349.48s, valid_score: 0.276500]
Wed 17 Apr 2024 04:31:46 INFO  valid result: 
recall@10 : 0.127    mrr@10 : 0.2765    ndcg@10 : 0.154    hit@10 : 0.5663    map@10 : 0.0794    precision@10 : 0.114    gauc : 0.9505    itemcoverage@10 : 0.1645    averagepopularity@10 : 11733.8445    giniindex@10 : 0.9871    shannonentropy@10 : 0.0031    tailpercentage@10 : 0.0
Wed 17 Apr 2024 04:31:48 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:33:43 INFO  epoch 5 training [time: 115.75s, train loss: 1663.6274]
Wed 17 Apr 2024 04:39:37 INFO  epoch 5 evaluating [time: 353.59s, valid_score: 0.290400]
Wed 17 Apr 2024 04:39:37 INFO  valid result: 
recall@10 : 0.1398    mrr@10 : 0.2904    ndcg@10 : 0.1653    hit@10 : 0.59    map@10 : 0.0868    precision@10 : 0.1211    gauc : 0.953    itemcoverage@10 : 0.1895    averagepopularity@10 : 11298.4748    giniindex@10 : 0.984    shannonentropy@10 : 0.0028    tailpercentage@10 : 0.0
Wed 17 Apr 2024 04:39:39 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:41:34 INFO  epoch 6 training [time: 115.38s, train loss: 1640.8822]
Wed 17 Apr 2024 04:47:27 INFO  epoch 6 evaluating [time: 353.33s, valid_score: 0.301900]
Wed 17 Apr 2024 04:47:27 INFO  valid result: 
recall@10 : 0.1469    mrr@10 : 0.3019    ndcg@10 : 0.1725    hit@10 : 0.6087    map@10 : 0.0908    precision@10 : 0.1257    gauc : 0.9548    itemcoverage@10 : 0.2215    averagepopularity@10 : 10602.8738    giniindex@10 : 0.9802    shannonentropy@10 : 0.0025    tailpercentage@10 : 0.0
Wed 17 Apr 2024 04:47:29 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:49:32 INFO  epoch 7 training [time: 123.53s, train loss: 1620.6841]
Wed 17 Apr 2024 04:55:24 INFO  epoch 7 evaluating [time: 351.63s, valid_score: 0.312200]
Wed 17 Apr 2024 04:55:24 INFO  valid result: 
recall@10 : 0.1533    mrr@10 : 0.3122    ndcg@10 : 0.1793    hit@10 : 0.6219    map@10 : 0.0952    precision@10 : 0.1293    gauc : 0.9562    itemcoverage@10 : 0.2401    averagepopularity@10 : 10346.1871    giniindex@10 : 0.9773    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Wed 17 Apr 2024 04:55:25 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 04:57:21 INFO  epoch 8 training [time: 115.17s, train loss: 1605.3421]
Wed 17 Apr 2024 05:03:12 INFO  epoch 8 evaluating [time: 351.64s, valid_score: 0.322000]
Wed 17 Apr 2024 05:03:12 INFO  valid result: 
recall@10 : 0.16    mrr@10 : 0.322    ndcg@10 : 0.1863    hit@10 : 0.6331    map@10 : 0.1003    precision@10 : 0.1327    gauc : 0.9572    itemcoverage@10 : 0.2521    averagepopularity@10 : 10180.3379    giniindex@10 : 0.9748    shannonentropy@10 : 0.0023    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:03:14 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 05:05:10 INFO  epoch 9 training [time: 116.53s, train loss: 1590.6117]
Wed 17 Apr 2024 05:11:00 INFO  epoch 9 evaluating [time: 349.93s, valid_score: 0.322300]
Wed 17 Apr 2024 05:11:00 INFO  valid result: 
recall@10 : 0.1641    mrr@10 : 0.3223    ndcg@10 : 0.1887    hit@10 : 0.6387    map@10 : 0.1017    precision@10 : 0.1342    gauc : 0.9579    itemcoverage@10 : 0.27    averagepopularity@10 : 9853.4445    giniindex@10 : 0.9722    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:11:02 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 05:12:58 INFO  epoch 10 training [time: 116.73s, train loss: 1579.1389]
Wed 17 Apr 2024 05:18:45 INFO  epoch 10 evaluating [time: 346.76s, valid_score: 0.324100]
Wed 17 Apr 2024 05:18:45 INFO  valid result: 
recall@10 : 0.1666    mrr@10 : 0.3241    ndcg@10 : 0.1903    hit@10 : 0.6434    map@10 : 0.1025    precision@10 : 0.1356    gauc : 0.9585    itemcoverage@10 : 0.2788    averagepopularity@10 : 9475.4931    giniindex@10 : 0.9694    shannonentropy@10 : 0.0021    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:18:46 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 05:20:43 INFO  epoch 11 training [time: 116.71s, train loss: 1568.9353]
Wed 17 Apr 2024 05:26:35 INFO  epoch 11 evaluating [time: 351.93s, valid_score: 0.327800]
Wed 17 Apr 2024 05:26:35 INFO  valid result: 
recall@10 : 0.1689    mrr@10 : 0.3278    ndcg@10 : 0.1929    hit@10 : 0.6477    map@10 : 0.1041    precision@10 : 0.1373    gauc : 0.9588    itemcoverage@10 : 0.2901    averagepopularity@10 : 9581.1958    giniindex@10 : 0.9684    shannonentropy@10 : 0.002    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:26:37 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 05:28:35 INFO  epoch 12 training [time: 118.06s, train loss: 1560.6779]
Wed 17 Apr 2024 05:34:26 INFO  epoch 12 evaluating [time: 351.71s, valid_score: 0.324800]
Wed 17 Apr 2024 05:34:26 INFO  valid result: 
recall@10 : 0.1688    mrr@10 : 0.3248    ndcg@10 : 0.1916    hit@10 : 0.6474    map@10 : 0.1032    precision@10 : 0.1363    gauc : 0.959    itemcoverage@10 : 0.3088    averagepopularity@10 : 9132.0617    giniindex@10 : 0.9645    shannonentropy@10 : 0.002    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:36:25 INFO  epoch 13 training [time: 118.45s, train loss: 1551.7751]
Wed 17 Apr 2024 05:42:12 INFO  epoch 13 evaluating [time: 346.84s, valid_score: 0.323700]
Wed 17 Apr 2024 05:42:12 INFO  valid result: 
recall@10 : 0.1683    mrr@10 : 0.3237    ndcg@10 : 0.191    hit@10 : 0.6483    map@10 : 0.1026    precision@10 : 0.1365    gauc : 0.9591    itemcoverage@10 : 0.3107    averagepopularity@10 : 9165.2471    giniindex@10 : 0.9647    shannonentropy@10 : 0.0019    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:44:11 INFO  epoch 14 training [time: 118.88s, train loss: 1544.6949]
Wed 17 Apr 2024 05:50:01 INFO  epoch 14 evaluating [time: 350.44s, valid_score: 0.327500]
Wed 17 Apr 2024 05:50:01 INFO  valid result: 
recall@10 : 0.1701    mrr@10 : 0.3275    ndcg@10 : 0.1931    hit@10 : 0.6511    map@10 : 0.1043    precision@10 : 0.1368    gauc : 0.9593    itemcoverage@10 : 0.3208    averagepopularity@10 : 9087.7774    giniindex@10 : 0.9628    shannonentropy@10 : 0.0019    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:51:59 INFO  epoch 15 training [time: 118.38s, train loss: 1537.9944]
Wed 17 Apr 2024 05:57:50 INFO  epoch 15 evaluating [time: 350.23s, valid_score: 0.323500]
Wed 17 Apr 2024 05:57:50 INFO  valid result: 
recall@10 : 0.1701    mrr@10 : 0.3235    ndcg@10 : 0.1915    hit@10 : 0.6501    map@10 : 0.103    precision@10 : 0.1363    gauc : 0.9593    itemcoverage@10 : 0.3339    averagepopularity@10 : 8647.3099    giniindex@10 : 0.9591    shannonentropy@10 : 0.0019    tailpercentage@10 : 0.0
Wed 17 Apr 2024 05:59:48 INFO  epoch 16 training [time: 118.75s, train loss: 1532.4169]
Wed 17 Apr 2024 06:05:41 INFO  epoch 16 evaluating [time: 352.94s, valid_score: 0.326900]
Wed 17 Apr 2024 06:05:41 INFO  valid result: 
recall@10 : 0.171    mrr@10 : 0.3269    ndcg@10 : 0.193    hit@10 : 0.6533    map@10 : 0.1039    precision@10 : 0.1372    gauc : 0.9594    itemcoverage@10 : 0.3414    averagepopularity@10 : 8648.3348    giniindex@10 : 0.9587    shannonentropy@10 : 0.0018    tailpercentage@10 : 0.0
Wed 17 Apr 2024 06:07:42 INFO  epoch 17 training [time: 120.38s, train loss: 1527.1281]
Wed 17 Apr 2024 06:13:38 INFO  epoch 17 evaluating [time: 356.42s, valid_score: 0.322800]
Wed 17 Apr 2024 06:13:38 INFO  valid result: 
recall@10 : 0.1697    mrr@10 : 0.3228    ndcg@10 : 0.1912    hit@10 : 0.6521    map@10 : 0.1024    precision@10 : 0.1368    gauc : 0.9595    itemcoverage@10 : 0.3448    averagepopularity@10 : 8489.0199    giniindex@10 : 0.9569    shannonentropy@10 : 0.0018    tailpercentage@10 : 0.0
Wed 17 Apr 2024 06:15:41 INFO  epoch 18 training [time: 122.89s, train loss: 1522.2114]
Wed 17 Apr 2024 06:21:40 INFO  epoch 18 evaluating [time: 358.54s, valid_score: 0.327900]
Wed 17 Apr 2024 06:21:40 INFO  valid result: 
recall@10 : 0.1734    mrr@10 : 0.3279    ndcg@10 : 0.195    hit@10 : 0.6556    map@10 : 0.1053    precision@10 : 0.1386    gauc : 0.9596    itemcoverage@10 : 0.3534    averagepopularity@10 : 8573.1056    giniindex@10 : 0.9571    shannonentropy@10 : 0.0018    tailpercentage@10 : 0.0
Wed 17 Apr 2024 06:21:42 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 06:23:56 INFO  epoch 19 training [time: 134.14s, train loss: 1518.0831]
Wed 17 Apr 2024 06:34:21 INFO  epoch 19 evaluating [time: 624.78s, valid_score: 0.324100]
Wed 17 Apr 2024 06:34:21 INFO  valid result: 
recall@10 : 0.1719    mrr@10 : 0.3241    ndcg@10 : 0.1926    hit@10 : 0.6553    map@10 : 0.1034    precision@10 : 0.1375    gauc : 0.9595    itemcoverage@10 : 0.3569    averagepopularity@10 : 8501.2243    giniindex@10 : 0.9557    shannonentropy@10 : 0.0018    tailpercentage@10 : 0.0
Wed 17 Apr 2024 07:00:05 INFO  epoch 20 training [time: 1544.31s, train loss: 1513.1296]
Wed 17 Apr 2024 07:06:15 INFO  epoch 20 evaluating [time: 370.26s, valid_score: 0.328500]
Wed 17 Apr 2024 07:06:15 INFO  valid result: 
recall@10 : 0.1741    mrr@10 : 0.3285    ndcg@10 : 0.1955    hit@10 : 0.6565    map@10 : 0.1058    precision@10 : 0.1387    gauc : 0.9595    itemcoverage@10 : 0.3612    averagepopularity@10 : 8499.0524    giniindex@10 : 0.9544    shannonentropy@10 : 0.0017    tailpercentage@10 : 0.0
Wed 17 Apr 2024 07:06:17 INFO  Saving current: saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 07:09:07 INFO  epoch 21 training [time: 170.38s, train loss: 1509.1747]
Wed 17 Apr 2024 07:15:04 INFO  epoch 21 evaluating [time: 356.74s, valid_score: 0.323600]
Wed 17 Apr 2024 07:15:04 INFO  valid result: 
recall@10 : 0.1723    mrr@10 : 0.3236    ndcg@10 : 0.1929    hit@10 : 0.6553    map@10 : 0.1035    precision@10 : 0.1378    gauc : 0.9596    itemcoverage@10 : 0.3707    averagepopularity@10 : 8326.4927    giniindex@10 : 0.9531    shannonentropy@10 : 0.0017    tailpercentage@10 : 0.0
Wed 17 Apr 2024 07:18:23 INFO  epoch 22 training [time: 198.83s, train loss: 1505.6963]
Wed 17 Apr 2024 07:24:26 INFO  epoch 22 evaluating [time: 362.73s, valid_score: 0.323800]
Wed 17 Apr 2024 07:24:26 INFO  valid result: 
recall@10 : 0.1715    mrr@10 : 0.3238    ndcg@10 : 0.1923    hit@10 : 0.6539    map@10 : 0.1035    precision@10 : 0.1368    gauc : 0.9596    itemcoverage@10 : 0.3744    averagepopularity@10 : 8254.9282    giniindex@10 : 0.9521    shannonentropy@10 : 0.0017    tailpercentage@10 : 0.0
Wed 17 Apr 2024 07:31:32 INFO  epoch 23 training [time: 425.61s, train loss: 1501.8169]
Wed 17 Apr 2024 07:37:32 INFO  epoch 23 evaluating [time: 360.08s, valid_score: 0.323900]
Wed 17 Apr 2024 07:37:32 INFO  valid result: 
recall@10 : 0.1731    mrr@10 : 0.3239    ndcg@10 : 0.1926    hit@10 : 0.6573    map@10 : 0.1029    precision@10 : 0.1378    gauc : 0.9595    itemcoverage@10 : 0.38    averagepopularity@10 : 8244.7157    giniindex@10 : 0.952    shannonentropy@10 : 0.0017    tailpercentage@10 : 0.0
Wed 17 Apr 2024 07:51:28 INFO  epoch 24 training [time: 836.27s, train loss: 1499.2533]
Wed 17 Apr 2024 08:01:04 INFO  epoch 24 evaluating [time: 575.83s, valid_score: 0.322300]
Wed 17 Apr 2024 08:01:04 INFO  valid result: 
recall@10 : 0.1717    mrr@10 : 0.3223    ndcg@10 : 0.1908    hit@10 : 0.6548    map@10 : 0.1016    precision@10 : 0.1362    gauc : 0.9595    itemcoverage@10 : 0.3901    averagepopularity@10 : 8053.5356    giniindex@10 : 0.9491    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 08:23:33 INFO  epoch 25 training [time: 1349.33s, train loss: 1496.0178]
Wed 17 Apr 2024 08:29:48 INFO  epoch 25 evaluating [time: 374.86s, valid_score: 0.322700]
Wed 17 Apr 2024 08:29:48 INFO  valid result: 
recall@10 : 0.1728    mrr@10 : 0.3227    ndcg@10 : 0.192    hit@10 : 0.657    map@10 : 0.1024    precision@10 : 0.1372    gauc : 0.9595    itemcoverage@10 : 0.3921    averagepopularity@10 : 7997.8965    giniindex@10 : 0.9485    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 08:58:57 INFO  epoch 26 training [time: 1748.73s, train loss: 1491.9977]
Wed 17 Apr 2024 09:05:24 INFO  epoch 26 evaluating [time: 387.06s, valid_score: 0.322000]
Wed 17 Apr 2024 09:05:24 INFO  valid result: 
recall@10 : 0.1726    mrr@10 : 0.322    ndcg@10 : 0.1916    hit@10 : 0.6556    map@10 : 0.1025    precision@10 : 0.1364    gauc : 0.9594    itemcoverage@10 : 0.4009    averagepopularity@10 : 7854.0244    giniindex@10 : 0.9462    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 09:38:16 INFO  epoch 27 training [time: 1971.50s, train loss: 1488.8989]
Wed 17 Apr 2024 09:44:27 INFO  epoch 27 evaluating [time: 371.27s, valid_score: 0.322600]
Wed 17 Apr 2024 09:44:27 INFO  valid result: 
recall@10 : 0.1747    mrr@10 : 0.3226    ndcg@10 : 0.193    hit@10 : 0.6587    map@10 : 0.1035    precision@10 : 0.1371    gauc : 0.9595    itemcoverage@10 : 0.4088    averagepopularity@10 : 7743.6212    giniindex@10 : 0.9446    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 10:21:43 INFO  epoch 28 training [time: 2235.60s, train loss: 1486.4094]
Wed 17 Apr 2024 10:27:51 INFO  epoch 28 evaluating [time: 368.47s, valid_score: 0.325600]
Wed 17 Apr 2024 10:27:51 INFO  valid result: 
recall@10 : 0.1741    mrr@10 : 0.3256    ndcg@10 : 0.194    hit@10 : 0.6597    map@10 : 0.1044    precision@10 : 0.1378    gauc : 0.9596    itemcoverage@10 : 0.4042    averagepopularity@10 : 7924.028    giniindex@10 : 0.9464    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 11:09:00 INFO  epoch 29 training [time: 2468.97s, train loss: 1484.0166]
Wed 17 Apr 2024 11:15:23 INFO  epoch 29 evaluating [time: 382.73s, valid_score: 0.326800]
Wed 17 Apr 2024 11:15:23 INFO  valid result: 
recall@10 : 0.1744    mrr@10 : 0.3268    ndcg@10 : 0.1943    hit@10 : 0.6608    map@10 : 0.1045    precision@10 : 0.1376    gauc : 0.9596    itemcoverage@10 : 0.4078    averagepopularity@10 : 7995.011    giniindex@10 : 0.9466    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 12:01:15 INFO  epoch 30 training [time: 2751.32s, train loss: 1481.2599]
Wed 17 Apr 2024 12:07:35 INFO  epoch 30 evaluating [time: 380.12s, valid_score: 0.326000]
Wed 17 Apr 2024 12:07:35 INFO  valid result: 
recall@10 : 0.1762    mrr@10 : 0.326    ndcg@10 : 0.195    hit@10 : 0.6622    map@10 : 0.1047    precision@10 : 0.1387    gauc : 0.9596    itemcoverage@10 : 0.414    averagepopularity@10 : 7976.8615    giniindex@10 : 0.9463    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 12:58:51 INFO  epoch 31 training [time: 3075.87s, train loss: 1478.6176]
Wed 17 Apr 2024 13:05:07 INFO  epoch 31 evaluating [time: 375.90s, valid_score: 0.326800]
Wed 17 Apr 2024 13:05:07 INFO  valid result: 
recall@10 : 0.176    mrr@10 : 0.3268    ndcg@10 : 0.1952    hit@10 : 0.6615    map@10 : 0.1053    precision@10 : 0.1378    gauc : 0.9596    itemcoverage@10 : 0.412    averagepopularity@10 : 7813.7935    giniindex@10 : 0.9444    shannonentropy@10 : 0.0016    tailpercentage@10 : 0.0
Wed 17 Apr 2024 13:05:07 INFO  Finished training, best eval result in epoch 20
Wed 17 Apr 2024 13:05:10 INFO  Loading model structure and parameters from saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
Wed 17 Apr 2024 13:11:09 INFO  The running environment of this training is as follows:
+-------------+-----------------+
| Environment |      Usage      |
+=============+=================+
| CPU         |     5.20 %      |
+-------------+-----------------+
| GPU         | 0.48 G/15.57 G  |
+-------------+-----------------+
| Memory      | 22.34 G/27.41 G |
+-------------+-----------------+
Wed 17 Apr 2024 13:11:09 INFO  best valid : OrderedDict([('recall@10', 0.1741), ('mrr@10', 0.3285), ('ndcg@10', 0.1955), ('hit@10', 0.6565), ('map@10', 0.1058), ('precision@10', 0.1387), ('gauc', 0.9595), ('itemcoverage@10', 0.3612), ('averagepopularity@10', 8499.0524), ('giniindex@10', 0.9544), ('shannonentropy@10', 0.0017), ('tailpercentage@10', 0.0)])
Wed 17 Apr 2024 13:11:09 INFO  test result: OrderedDict([('recall@10', 0.1944), ('mrr@10', 0.3894), ('ndcg@10', 0.2394), ('hit@10', 0.6777), ('map@10', 0.1443), ('precision@10', 0.1691), ('gauc', 0.9618), ('itemcoverage@10', 0.376), ('averagepopularity@10', 8204.8427), ('giniindex@10', 0.9506), ('shannonentropy@10', 0.0017), ('tailpercentage@10', 0.0)])
Wed 17 Apr 2024 13:15:49 INFO  
General Hyper Parameters:
gpu_id = 0
use_gpu = True
seed = 2020
state = INFO
reproducibility = True
data_path = data/ml-10m_50U10I
checkpoint_dir = saved/ml-10m_50U10I/KGNNLS
show_progress = True
save_dataset = False
dataset_save_path = None
save_dataloaders = False
dataloaders_save_path = None
log_wandb = False

Training Hyper Parameters:
epochs = 200
train_batch_size = 2048
learner = adam
learning_rate = 0.001
train_neg_sample_args = {'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}
eval_step = 1
stopping_step = 10
clip_grad_norm = None
weight_decay = 0.0
loss_decimal_place = 4

Evaluation Hyper Parameters:
eval_args = {'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}
repeatable = False
metrics = ['Recall', 'MRR', 'NDCG', 'Hit', 'MAP', 'Precision', 'GAUC', 'ItemCoverage', 'AveragePopularity', 'GiniIndex', 'ShannonEntropy', 'TailPercentage']
topk = [10]
valid_metric = MRR@10
valid_metric_bigger = True
eval_batch_size = 4096
metric_decimal_place = 4

Dataset Hyper Parameters:
field_separator = 	
seq_separator =  
USER_ID_FIELD = user_id
ITEM_ID_FIELD = item_id
RATING_FIELD = rating
TIME_FIELD = timestamp
seq_len = None
LABEL_FIELD = label
threshold = None
NEG_PREFIX = neg_
load_col = {'inter': ['user_id', 'item_id', 'rating', 'timestamp'], 'kg': ['head_id', 'relation_id', 'tail_id'], 'link': ['item_id', 'entity_id']}
unload_col = None
unused_col = None
additional_feat_suffix = None
rm_dup_inter = None
val_interval = None
filter_inter_by_user_or_item = True
user_inter_num_interval = [0,inf)
item_inter_num_interval = [0,inf)
alias_of_user_id = None
alias_of_item_id = None
alias_of_entity_id = None
alias_of_relation_id = None
preload_weight = None
normalize_field = None
normalize_all = None
ITEM_LIST_LENGTH_FIELD = item_length
LIST_SUFFIX = _list
MAX_ITEM_LIST_LENGTH = 50
POSITION_FIELD = position_id
HEAD_ENTITY_ID_FIELD = head_id
TAIL_ENTITY_ID_FIELD = tail_id
RELATION_ID_FIELD = relation_id
ENTITY_ID_FIELD = entity_id
benchmark_filename = None

Other Hyper Parameters: 
worker = 0
wandb_project = recbole
shuffle = True
require_pow = False
enable_amp = False
enable_scaler = False
transform = None
embedding_size = 64
n_iter = 1
aggregator = sum
reg_weight = 1e-07
neighbor_sample_size = 4
ls_weight = 0.5
numerical_features = []
discretization = None
kg_reverse_r = False
entity_kg_num_interval = [0,inf)
relation_kg_num_interval = [0,inf)
MODEL_TYPE = ModelType.KNOWLEDGE
encoding = utf-8
device = cuda
my_log_file = /mnt/batch/tasks/shared/LS_root/mounts/clusters/fontanagpu/code/sustainability-of-recsys/log/carbon_default.log
MODEL_INPUT_TYPE = InputType.PAIRWISE
eval_type = EvaluatorType.RANKING
single_spec = True
local_rank = 0
valid_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}
test_neg_sample_args = {'distribution': 'uniform', 'sample_num': 'none'}


Wed 17 Apr 2024 13:16:35 INFO  ml-10m_50U10I
The number of users: 50001
Average actions of users: 140.97052
The number of items: 9938
Average actions of items: 709.3213243433632
The number of inters: 7048526
The sparsity of the dataset: 98.58152847005447%
Remain Fields: ['entity_id', 'user_id', 'item_id', 'rating', 'head_id', 'relation_id', 'tail_id']
The number of entities: 175647
The number of relations: 33
The number of triples: 521125
The number of items that have been linked to KG: 9937
Wed 17 Apr 2024 13:17:01 INFO  [Training]: train_batch_size = [2048] train_neg_sample_args: [{'distribution': 'uniform', 'sample_num': 1, 'dynamic': False, 'candidate_num': 0, 'alpha': 1.0}]
Wed 17 Apr 2024 13:17:01 INFO  [Evaluation]: eval_batch_size = [4096] eval_args: [{'split': {'RS': [0.8, 0.1, 0.1]}, 'order': 'RO', 'group_by': 'user', 'mode': {'valid': 'full', 'test': 'full'}}]
Wed 17 Apr 2024 13:17:29 INFO  Loading model structure and parameters from saved/ml-10m_50U10I/KGNNLS/KGNNLS-Apr-17-2024_03-51-59.pth
